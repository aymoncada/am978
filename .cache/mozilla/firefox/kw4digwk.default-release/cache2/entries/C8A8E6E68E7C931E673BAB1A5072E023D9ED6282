$(document).ready(function() {
    replace_content('outer', format('login', {}));
    start_app_login();
});

function dispatcher_add(fun) {
    dispatcher_modules.push(fun);
    if (dispatcher_modules.length == extension_count) {
        start_app();
    }
}

function dispatcher() {
    for (var i in dispatcher_modules) {
        dispatcher_modules[i](this);
    }
}

function set_auth_pref(userinfo) {
    // clear a local storage value used by earlier versions
    clear_local_pref('auth');

    var b64 = b64_encode_utf8(userinfo);
    var date  = new Date();
    // 8 hours from now
    date.setHours(date.getHours() + 8);
    store_cookie_value_with_expiration('auth', encodeURIComponent(b64), date);
}

function login_route () {
    var userpass = '' + this.params['username'] + ':' + this.params['password'],
        location = window.location.href,
        hash = window.location.hash;
    set_auth_pref(decodeURIComponent(userpass));
    location = location.substr(0, location.length - hash.length);
    window.location.replace(location);
    // because we change url, we don't need to hit check_login as
    // we'll end up doing that at the bottom of start_app_login after
    // we've changed url.
}

function login_route_with_path() {
  var params = ('' + this.params['splat']).split('/');
  var user = params.shift();
  var pass = params.shift();
  var userpass = '' + user + ':' + pass,
        location = window.location.href,
        hash = window.location.hash;
    set_auth_pref(decodeURIComponent(userpass));
    location = location.substr(0, location.length - hash.length) + '#/' + params.join('/');
    check_login();
    window.location.replace(location);
}

function start_app_login() {
    app = new Sammy.Application(function () {
        this.get('#/', function() {});
        this.put('#/login', function() {
            username = this.params['username'];
            password = this.params['password'];
            set_auth_pref(username + ':' + password);
            check_login();
        });
        this.get('#/login/:username/:password', login_route);
        this.get(/\#\/login\/(.*)/, login_route_with_path);
    });
    app.run();
    if (get_cookie_value('auth') != null) {
        check_login();
    }
}

function check_login() {
    user = JSON.parse(sync_get('/whoami'));
    if (user == false) {
        // clear a local storage value used by earlier versions
        clear_pref('auth');
        clear_cookie_value('auth');
        replace_content('login-status', '<p>Login failed</p>');
    }
    else {
        replace_content('outer', format('layout', {}));
        setup_global_vars();
        setup_constant_events();
        update_vhosts();
        update_interval();
        setup_extensions();
    }
}

function start_app() {
    if (app !== undefined) {
        app.unload();
    }
    // Oh boy. Sammy uses various different methods to determine if
    // the URL hash has changed. Unsurprisingly this is a native event
    // in modern browsers, and falls back to an icky polling function
    // in MSIE. But it looks like there's a bug. The polling function
    // should get installed when the app is started. But it's guarded
    // behind if (Sammy.HashLocationProxy._interval != null). And of
    // course that's not specific to the application; it's pretty
    // global. So we need to manually clear that in order for links to
    // work in MSIE.
    // Filed as https://github.com/quirkey/sammy/issues/171
    //
    // Note for when we upgrade: HashLocationProxy has become
    // DefaultLocationProxy in later versions, but otherwise the issue
    // remains.

    // updated to the version  0.7.6 this _interval = null is fixed
    // just leave the history here.
    //Sammy.HashLocationProxy._interval = null;


    app = new Sammy.Application(dispatcher);
    app.run();
    var url = this.location.toString();
    if (url.indexOf('#') == -1) {
        this.location = url + '#/';
    }
}

function setup_constant_events() {
    $('#update-every').change(function() {
            var interval = $(this).val();
            store_pref('interval', interval);
            if (interval == '')
                interval = null;
            else
                interval = parseInt(interval);
            set_timer_interval(interval);
        });
    $('#show-vhost').change(function() {
            current_vhost = $(this).val();
            store_pref('vhost', current_vhost);
            update();
        });
    if (!vhosts_interesting) {
        $('#vhost-form').hide();
    }
}

function update_vhosts() {
    var vhosts = JSON.parse(sync_get('/vhosts'));
    vhosts_interesting = vhosts.length > 1;
    if (vhosts_interesting)
        $('#vhost-form').show();
    else
        $('#vhost-form').hide();
    var select = $('#show-vhost').get(0);
    select.options.length = vhosts.length + 1;
    var index = 0;
    for (var i = 0; i < vhosts.length; i++) {
        var vhost = vhosts[i].name;
        select.options[i + 1] = new Option(vhost, vhost);
        if (vhost == current_vhost) index = i + 1;
    }
    select.selectedIndex = index;
    current_vhost = select.options[index].value;
    store_pref('vhost', current_vhost);
}

function setup_extensions() {
    var extensions = JSON.parse(sync_get('/extensions'));
    extension_count = 0;
    for (var i in extensions) {
        var extension = extensions[i];
        if ($.isPlainObject(extension) && extension.hasOwnProperty("javascript")) {
            dynamic_load(extension.javascript);
            extension_count++;
        }
    }
}

function dynamic_load(filename) {
    var element = document.createElement('script');
    element.setAttribute('type', 'text/javascript');
    element.setAttribute('src', 'js/' + filename);
    document.getElementsByTagName("head")[0].appendChild(element);
}

function update_interval() {
    var intervalStr = get_pref('interval');
    var interval;

    if (intervalStr == null)    interval = 5000;
    else if (intervalStr == '') interval = null;
    else                        interval = parseInt(intervalStr);

    if (isNaN(interval)) interval = null; // Prevent DoS if cookie malformed

    set_timer_interval(interval);

    var select = $('#update-every').get(0);
    var opts = select.options;
    for (var i = 0; i < opts.length; i++) {
        if (opts[i].value == intervalStr) {
            select.selectedIndex = i;
            break;
        }
    }
}

function go_to(url) {
    this.location = url;
}

function set_timer_interval(interval) {
    timer_interval = interval;
    reset_timer();
}

function reset_timer() {
    clearInterval(timer);
    if (timer_interval != null) {
        timer = setInterval(partial_update, timer_interval);
    }
}

function update_manual(div, query) {
    var path;
    var template;
    if (query == 'memory' || query == 'binary') {
        path = current_reqs['node']['path'] + '?' + query + '=true';
        template = query;
    }
    var data = JSON.parse(sync_get(path));

    replace_content(div, format(template, data));
    postprocess_partial();
}

function render(reqs, template, highlight) {
    current_template = template;
    current_reqs = reqs;
    for (var i in outstanding_reqs) {
        outstanding_reqs[i].abort();
    }
    outstanding_reqs = [];
    current_highlight = highlight;
    update();
}

function update() {
    replace_content('debug', '');
    clearInterval(timer);
    with_update(function(html) {
            update_navigation();
            replace_content('main', html);
            postprocess();
            postprocess_partial();
            render_charts();
            maybe_scroll();
            reset_timer();
        });
}

function partial_update() {
    if (!$(".pagination_class").is(":focus")) {
        if ($('.updatable').length > 0) {
            if (update_counter >= 200) {
                update_counter = 0;
                full_refresh();
                return;
            }
            with_update(function(html) {
                update_counter++;
                replace_content('scratch', html);
                var befores = $('#main .updatable');
                var afters = $('#scratch .updatable');
                if (befores.length != afters.length) {
                    console.log("before/after mismatch! Doing a full reload...");
                    full_refresh();
                }
                for (var i = 0; i < befores.length; i++) {
                    $(befores[i]).empty().append($(afters[i]).contents());
                }
                replace_content('scratch', '');
                postprocess_partial();
                render_charts();
            });
        }
    }
}

function update_navigation() {
    var l1 = '';
    var l2 = '';
    var descend = null;

    for (var k in NAVIGATION) {
        var val = NAVIGATION[k];
        var path = val;
        while (!leaf(path)) {
            path = first_showable_child(path);
        }
        var selected = false;
        if (contains_current_highlight(val)) {
            selected = true;
            if (!leaf(val)) {
                descend = nav(val);
            }
        }
        if (show(path)) {
            l1 += '<li><a href="' + nav(path) + '"' +
                (selected ? ' class="selected"' : '') + '>' + k + '</a></li>';
        }
    }

    if (descend) {
        l2 = obj_to_ul(descend);
        $('#main').addClass('with-rhs');
    }
    else {
        $('#main').removeClass('with-rhs');
    }

    replace_content('tabs', l1);
    replace_content('rhs', l2);
}

function nav(pair) {
    return pair[0];
}

function show(pair) {
    return jQuery.inArray(pair[1], user_tags) != -1;
}

function leaf(pair) {
    return typeof(nav(pair)) == 'string';
}

function first_showable_child(pair) {
    var items = pair[0];
    var ks = keys(items);
    for (var i = 0; i < ks.length; i++) {
        var child = items[ks[i]];
        if (show(child)) return child;
    }
    return items[ks[0]]; // We'll end up not showing it anyway
}

function contains_current_highlight(val) {
    if (leaf(val)) {
        return current_highlight == nav(val);
    }
    else {
        var b = false;
        for (var k in val) {
            b |= contains_current_highlight(val[k]);
        }
        return b;
    }
}

function obj_to_ul(val) {
    var res = '<ul>';
    for (var k in val) {
        var obj = val[k];
        if (show(obj)) {
            res += '<li>';
            if (leaf(obj)) {
                res += '<a href="' + nav(obj) + '"' +
                    (current_highlight == nav(obj) ? ' class="selected"' : '') +
                    '>' + k + '</a>';
            }
            else {
                res += obj_to_ul(nav(obj));
            }
            res += '</li>';
        }
    }
    return res + '</ul>';
}

function full_refresh() {
    store_pref('position', x_position() + ',' + y_position());
    location.reload();
}

function maybe_scroll() {
    var pos = get_pref('position');
    if (pos) {
        clear_pref('position');
        var xy = pos.split(",");
        window.scrollTo(parseInt(xy[0]), parseInt(xy[1]));
    }
}

function x_position() {
    return window.pageXOffset ?
        window.pageXOffset :
        document.documentElement.scrollLeft ?
        document.documentElement.scrollLeft :
        document.body.scrollLeft;
}

function y_position() {
    return window.pageYOffset ?
        window.pageYOffset :
        document.documentElement.scrollTop ?
        document.documentElement.scrollTop :
        document.body.scrollTop;
}

function with_update(fun) {
    if(outstanding_reqs.length > 0){
        return false;
    }
    with_reqs(apply_state(current_reqs), [], function(json) {
            var html = format(current_template, json);
            fun(html);
            update_status('ok');
        });
    return true;
}

function apply_state(reqs) {
    var reqs2 = {};
    for (k in reqs) {
        var req = reqs[k];
        var options = {};
        if (typeof(req) == "object") {
            options = req.options;
            req = req.path;
        }
        var req2;
        if (options['vhost'] != undefined && current_vhost != '') {
            var indexPage = req.indexOf("?page=");
            if (indexPage >- 1) {
				pageUrl = req.substr(indexPage);
				req2 = req.substr(0,indexPage) + '/' + esc(current_vhost) + pageUrl;
            } else

              req2 = req + '/' + esc(current_vhost);
        }
        else {
            req2 = req;
        }
        var qs = [];
        if (options['sort'] != undefined && current_sort != null) {
            qs.push('sort=' + current_sort);
            qs.push('sort_reverse=' + current_sort_reverse);
        }
        if (options['ranges'] != undefined) {
            for (i in options['ranges']) {
                var type = options['ranges'][i];
                var range = get_pref('chart-range').split('|');
                var prefix;
                if (type.substring(0, 8) == 'lengths-') {
                    prefix = 'lengths';
                }
                else if (type.substring(0, 10) == 'msg-rates-') {
                    prefix = 'msg_rates';
                }
                else if (type.substring(0, 11) == 'data-rates-') {
                    prefix = 'data_rates';
                }
                else if (type == 'node-stats') {
                    prefix = 'node_stats';
                }
                qs.push(prefix + '_age=' + parseInt(range[0]));
                qs.push(prefix + '_incr=' + parseInt(range[1]));
            }
        }
        /* Unknown options are used as query parameters as is. */
        Object.keys(options).forEach(function (key) {
          /* Skip known keys we already handled and undefined parameters. */
          if (key == 'vhost' || key == 'sort' || key == 'ranges')
            return;
          if (!key || options[key] == undefined)
            return;

          qs.push(esc(key) + '=' + esc(options[key]));
        });
        qs = qs.join('&');
        if (qs != '')
            if (req2.indexOf("?page=") >- 1)
            qs = '&' + qs;
             else
            qs = '?' + qs;

        reqs2[k] = req2 + qs;
    }
    return reqs2;
}

function show_popup(type, text, _mode) {
    var cssClass = '.form-popup-' + type;
    function hide() {
        $(cssClass).fadeOut(100, function() {
            $(this).remove();
        });
    }
    hide();
    $('#outer').after(format('popup', {'type': type, 'text': text}));
    $(cssClass).fadeIn(100);
    $(cssClass + ' span').click(function () {
        $('.popup-owner').removeClass('popup-owner');
        hide();
    });
}

function submit_import(form) {
    if (form.file.value) {
        var confirm_upload = confirm('Are you sure you want to import a definitions file? Some entities (vhosts, users, queues, etc) may be overwritten!');
        if (confirm_upload === true) {
            var idx = $("select[name='vhost-upload'] option:selected").index();
            var vhost = ((idx <= 0) ? "" : "/" + esc($("select[name='vhost-upload'] option:selected").val()));
            form.action ="api/definitions" + vhost + '?auth=' + get_cookie_value('auth');
            form.submit();
            window.location.replace("../../#/import-succeeded");
        } else {
            return false;
        }
    } else {
        return false;
    }
};

function postprocess() {
    $('form.confirm-queue').submit(function() {
        return confirm("Are you sure? The queue is going to be deleted. " +
                       "Messages cannot be recovered after deletion.");
        });

    $('form.confirm-purge-queue').submit(function() {
        return confirm("Are you sure? Messages cannot be recovered after purging.");
        });

    $('form.confirm').submit(function() {
            return confirm("Are you sure? This object cannot be recovered " +
                           "after deletion.");
        });

    $('label').map(function() {
            if ($(this).attr('for') == '') {
                var id = 'auto-label-' + Math.floor(Math.random()*1000000000);
                var input = $(this).parents('tr').first().find('input, select');
                if (input.attr('id') == '') {
                    $(this).attr('for', id);
                    input.attr('id', id);
                }
            }
        });

    $('#download-definitions').click(function() {
            var idx = $("select[name='vhost-download'] option:selected").index();
            var vhost = ((idx <=0 ) ? "" : "/" + esc($("select[name='vhost-download'] option:selected").val()));
            var path = 'api/definitions' + vhost + '?download=' +
                esc($('#download-filename').val()) +
                '&auth=' + get_cookie_value('auth');
            window.location = path;
            setTimeout('app.run()');
            return false;
        });

    $('.update-manual').click(function() {
            update_manual($(this).attr('for'), $(this).attr('query'));
        });

    $(document).on('keyup', '.multifield input', function() {
            update_multifields();
        });

    $(document).on('change', '.multifield select', function() {
            update_multifields();
        });

    $('.controls-appearance').change(function() {
        var params = $(this).get(0).options;
        var selected = $(this).val();

        for (i = 0; i < params.length; i++) {
            var param = params[i].value;
            if (param == selected) {
                $('#' + param + '-div').slideDown(100);
            } else {
                $('#' + param + '-div').slideUp(100);
            }
        }
    });

    $(document).on('click', '.help', function() {
      show_popup('help', HELP[$(this).attr('id')]);
    });

    $(document).on('click', '.popup-options-link', function() {
        $('.popup-owner').removeClass('popup-owner');
        $(this).addClass('popup-owner');
        var template = $(this).attr('type') + '-options';
        show_popup('options', format(template, {span: $(this)}), 'fade');
    });

    $(document).on('click', '.rate-visibility-option', function() {
        var k = $(this).attr('data-pref');
        var show = get_pref(k) !== 'true';
        store_pref(k, '' + show);
        partial_update();
    });

    $(document).on('focus', 'input, select', function() {
        update_counter = 0; // If there's interaction, reset the counter.
    });

    $('.tag-link').click(function() {
        $('#tags').val($(this).attr('tag'));
    });

    $('.argument-link').click(function() {
        var field = $(this).attr('field');
        var row = $('#' + field).find('.mf').last();
        var key = row.find('input').first();
        var value = row.find('input').last();
        var type = row.find('select').last();
        key.val($(this).attr('key'));
        value.val($(this).attr('value'));
        type.val($(this).attr('type'));
        update_multifields();
    });

    $(document).on('click', 'form.auto-submit select, form.auto-submit input', function(){
        $(this).parents('form').submit();
    });

    $('#filter').on('keyup', debounce(update_filter, 500));

    $('#filter-regex-mode').change(update_filter_regex_mode);

    $('#truncate').on('keyup', debounce(update_truncate, 500));

    if (! user_administrator) {
        $('.administrator-only').remove();
    }

    update_multifields();
}

function url_pagination_template(template, defaultPage, defaultPageSize){
    var page_number_request = fmt_page_number_request(template, defaultPage);
    var page_size = fmt_page_size_request(template, defaultPageSize);
    var name_request = fmt_filter_name_request(template, "");
    var use_regex = fmt_regex_request(template, "") == "checked";
    if (use_regex) {
        name_request = esc(name_request);
    }
    return  '/' + template +
        '?page=' +  page_number_request +
        '&page_size=' + page_size +
        '&name=' + name_request +
        '&use_regex=' + use_regex;
}

function stored_page_info(template, page_start){
    var pageSize = fmt_strip_tags($('#' + template+'-pagesize').val());
    var filterName = fmt_strip_tags($('#' + template+'-name').val());

    store_pref(template + '_current_page_number', page_start);
    if (filterName != null && filterName != undefined) {
        store_pref(template + '_current_filter_name', filterName);
    }
    var regex_on =  $("#" + template + "-filter-regex-mode").is(':checked');

    if (regex_on != null && regex_on != undefined) {
        store_pref(template + '_current_regex', regex_on ? "checked" : " " );
    }

    if (pageSize != null && pageSize != undefined) {
        store_pref(template + '_current_page_size', pageSize);
    }
}

function update_pages(template, page_start){
     stored_page_info(template, page_start);
     switch (template) {
         case 'queues' : renderQueues(); break;
         case 'exchanges' : renderExchanges(); break;
         case 'connections' : renderConnections(); break;
         case 'channels' : renderChannels(); break;
     }
}

function renderQueues() {
    render({'queues':  {path: url_pagination_template('queues', 1, 100),
                        options: {sort:true, vhost:true, pagination:true}},
                        'vhosts': '/vhosts'}, 'queues', '#/queues');
}

function renderExchanges() {
    render({'exchanges':  {path: url_pagination_template('exchanges', 1, 100),
                          options: {sort:true, vhost:true, pagination:true}},
                         'vhosts': '/vhosts'}, 'exchanges', '#/exchanges');
}

function renderConnections() {
    render({'connections': {path:  url_pagination_template('connections', 1, 100),
                            options: {sort:true}}},
                            'connections', '#/connections');
}

function renderChannels() {
    render({'channels': {path:  url_pagination_template('channels', 1, 100),
                        options: {sort:true}}},
                        'channels', '#/channels');
}

function update_pages_from_ui(sender) {
    var val = $(sender).val();
    var raw = !!$(sender).attr('data-page-start') ? $(sender).attr('data-page-start') : val;
    var s   = fmt_strip_tags(raw);
    update_pages(current_template, s);
}

function postprocess_partial() {
    $('.pagination_class_input').keypress(function(e) {
        if (e.keyCode == 13) {
            update_pages_from_ui(this);
        }
    });

    $('.pagination_class_checkbox').click(function(e) {
        update_pages_from_ui(this);
    });

    $('.pagination_class_select').change(function(e) {
        update_pages_from_ui(this);
    });

    setup_visibility();

    $('#main').off('click', 'div.section h2, div.section-hidden h2');
    $('#main').on('click', 'div.section h2, div.section-hidden h2', function() {
            toggle_visibility($(this));
        });

    $('.sort').click(function() {
            var sort = $(this).attr('sort');
            if (current_sort == sort) {
                current_sort_reverse = ! current_sort_reverse;
            }
            else {
                current_sort = sort;
                current_sort_reverse = false;
            }
            update();
        });

    // TODO remove this hack when we get rid of "updatable"
    if ($('#filter-warning-show').length > 0) {
        $('#filter-truncate').addClass('filter-warning');
    }
    else {
        $('#filter-truncate').removeClass('filter-warning');
    }
}

function update_multifields() {
    $('div.multifield').each(function(index) {
        update_multifield($(this), true);
    });
}

function update_multifield(multifield, dict) {
    var largest_id = 0;
    var empty_found = false;
    var name = multifield.attr('id');
    var type_inputs = $('#' + name + ' *[name$="_mftype"]');
    type_inputs.each(function(index) {
        var re = new RegExp(name + '_([0-9]*)_mftype');
        var match = $(this).attr('name').match(re);
        if (!match) return;
        var id = parseInt(match[1]);
        largest_id = Math.max(id, largest_id);
        var prefix = name + '_' + id;
        var type = $(this).val();
        var input = $('#' + prefix + '_mfvalue');
        if (type == 'list') {
            if (input.size() == 1) {
                input.replaceWith('<div class="multifield-sub" id="' + prefix +
                                  '"></div>');
            }
            update_multifield($('#' + prefix), false);
        }
        else {
            if (input.size() == 1) {
                var key = dict ? $('#' + prefix + '_mfkey').val() : '';
                var value = input.val();
                if (key == '' && value == '') {
                    if (index == type_inputs.length - 1) {
                        empty_found = true;
                    }
                    else {
                        $(this).parents('.mf').first().remove();
                    }
                }
            }
            else {
                $('#' + prefix).replaceWith(multifield_input(prefix, 'value',
                                                             'text'));
            }
        }
    });
    if (!empty_found) {
        var prefix = name + '_' + (largest_id + 1);
        var t = multifield.hasClass('string-only') ? 'hidden' : 'select';
        var val_type = multifield_input(prefix, 'value', 'text') + ' ' +
            multifield_input(prefix, 'type', t);

        if (dict) {
            multifield.append('<table class="mf"><tr><td>' +
                              multifield_input(prefix, 'key', 'text') +
                              '</td><td class="equals"> = </td><td>' +
                              val_type + '</td></tr></table>');
        }
        else {
            multifield.append('<div class="mf">' + val_type + '</div>');
        }
    }
}

function multifield_input(prefix, suffix, type) {
    if (type == 'hidden' ) {
        return '<input type="hidden" id="' + prefix + '_mf' + suffix +
            '" name="' + prefix + '_mf' + suffix + '" value="string"/>';
    }
    else if (type == 'text' ) {
        return '<input type="text" id="' + prefix + '_mf' + suffix +
            '" name="' + prefix + '_mf' + suffix + '" value=""/>';
    }
    else if (type == 'select' ) {
        return '<select id="' + prefix + '_mf' + suffix + '" name="' + prefix +
            '_mf' + suffix + '">' +
            '<option value="string">String</option>' +
            '<option value="number">Number</option>' +
            '<option value="boolean">Boolean</option>' +
            '<option value="list">List</option>' +
            '</select>';
    }
}

function update_filter_regex(jElem) {
    current_filter_regex = null;
    jElem.parents('.filter').children('.status-error').remove();
    if (current_filter_regex_on && $.trim(current_filter).length > 0) {
        try {
            current_filter_regex = new RegExp(current_filter,'i');
        } catch (e) {
            jElem.parents('.filter').append('<p class="status-error">' +
                                            fmt_escape_html(e.message) + '</p>');
        }
    }
}

function update_filter_regex_mode() {
    current_filter_regex_on = $(this).is(':checked');
    update_filter_regex($(this));
    partial_update();
}

function update_filter() {
    current_filter = $(this).val();
    var table = $(this).parents('table').first();
    table.removeClass('filter-active');
    if ($(this).val() != '') {
        table.addClass('filter-active');
    }
    update_filter_regex($(this));
    partial_update();
}

function update_truncate() {
    var current_truncate_str =
        $(this).val().replace(new RegExp('\\D', 'g'), '');
    if (current_truncate_str == '')
        current_truncate_str = '0';
    if ($(this).val() != current_truncate_str)
        $(this).val(current_truncate_str);
    current_truncate = parseInt(current_truncate_str, 10);
    store_pref('truncate', current_truncate);
    partial_update();
}

function setup_visibility() {
    $('div.section,div.section-hidden').each(function(_index) {
        var pref = section_pref(current_template,
                                $(this).children('h2').text());
        var show = get_pref(pref);
        if (show == null) {
            show = $(this).hasClass('section');
        }
        else {
            show = show == 't';
        }
        if (show) {
            $(this).addClass('section-visible');
            // Workaround for... something. Although div.hider is
            // display:block anyway, not explicitly setting this
            // prevents the first slideToggle() from animating
            // successfully; instead the element just vanishes.
            $(this).find('.hider').attr('style', 'display:block;');
        }
        else {
            $(this).addClass('section-invisible');
        }
    });
}

function toggle_visibility(item) {
    var hider = item.next();
    var all = item.parent();
    var pref = section_pref(current_template, item.text());
    item.next().slideToggle(100);
    if (all.hasClass('section-visible')) {
        if (all.hasClass('section'))
            store_pref(pref, 'f');
        else
            clear_pref(pref);
        all.removeClass('section-visible');
        all.addClass('section-invisible');
    }
    else {
        if (all.hasClass('section-hidden')) {
            store_pref(pref, 't');
        } else {
            clear_pref(pref);
        }
        all.removeClass('section-invisible');
        all.addClass('section-visible');
    }
}

function publish_msg(params0) {
    try {
        var params = params_magic(params0);
        publish_msg0(params);
    } catch (e) {
        show_popup('warn', fmt_escape_html(e));
        return false;
    }
}

function publish_msg0(params) {
    var path = fill_path_template('/exchanges/:vhost/:name/publish', params);
    params['payload_encoding'] = 'string';
    params['properties'] = {};
    params['properties']['delivery_mode'] = parseInt(params['delivery_mode']);
    if (params['headers'] != '')
        params['properties']['headers'] = params['headers'];
    var props = [['content_type',     'str'],
                 ['content_encoding', 'str'],
                 ['correlation_id',   'str'],
                 ['reply_to',         'str'],
                 ['expiration',       'str'],
                 ['message_id',       'str'],
                 ['type',             'str'],
                 ['user_id',          'str'],
                 ['app_id',           'str'],
                 ['cluster_id',       'str'],
                 ['priority',         'int'],
                 ['timestamp',        'int']];
    for (var i in props) {
        var name = props[i][0];
        var type = props[i][1];
        if (params['props'][name] != undefined && params['props'][name] != '') {
            var value = params['props'][name];
            if (type == 'int') value = parseInt(value);
            params['properties'][name] = value;
        }
    }
    with_req('POST', path, JSON.stringify(params), function(resp) {
            var result = jQuery.parseJSON(resp.responseText);
            if (result.routed) {
                show_popup('info', 'Message published.');
            } else {
                show_popup('warn', 'Message published, but not routed.');
            }
        });
}

function get_msgs(params) {
    var path = fill_path_template('/queues/:vhost/:name/get', params);
    with_req('POST', path, JSON.stringify(params), function(resp) {
            var msgs = jQuery.parseJSON(resp.responseText);
            if (msgs.length == 0) {
                show_popup('info', 'Queue is empty');
            } else {
                $('#msg-wrapper').slideUp(200);
                replace_content('msg-wrapper', format('messages', {'msgs': msgs}));
                $('#msg-wrapper').slideDown(200);
            }
        });
}

function with_reqs(reqs, acc, fun) {
    if (keys(reqs).length > 0) {
        var key = keys(reqs)[0];
        with_req('GET', reqs[key], null, function(resp) {
                acc[key] = jQuery.parseJSON(resp.responseText);
                var remainder = {};
                for (var k in reqs) {
                    if (k != key) remainder[k] = reqs[k];
                }
                with_reqs(remainder, acc, fun);
            });
    }
    else {
        fun(acc);
    }
}

function replace_content(id, html) {
    $("#" + id).html(html);
}

var ejs_cached = {};

function format(template, json) {
    try {
        var cache = true;
        if (!(template in ejs_cached)) {
            ejs_cached[template] = true;
            cache = false;
        }
        var tmpl = new EJS({url: 'js/tmpl/' + template + '.ejs', cache: cache});
        return tmpl.render(json);
    } catch (err) {
        clearInterval(timer);
        console.log("Uncaught error: " + err);
        console.log("Stack: " + err['stack']);
        debug(err['name'] + ": " + err['message'] + "\n" + err['stack'] + "\n");
    }
}

function update_status(status) {
    var text;
    if (status == 'ok')
        text = "Refreshed " + fmt_date(new Date());
    else if (status == 'error') {
        var next_try = new Date(new Date().getTime() + timer_interval);
        text = "Error: could not connect to server since " +
            fmt_date(last_successful_connect) + ". Will retry at " +
            fmt_date(next_try) + ".";
    }
    else
        throw("Unknown status " + status);

    var html = format('status', {status: status, text: text});
    replace_content('status', html);
}

function has_auth_cookie_value() {
    return get_cookie_value('auth') != null;
}

function auth_header() {
    if(has_auth_cookie_value()) {
        return "Basic " + decodeURIComponent(get_cookie_value('auth'));    
    } else {
        return null;
    }
}

function with_req(method, path, body, fun) {
    if(!has_auth_cookie_value()) {
        // navigate to the login form
        location.reload();
        return;
    }

    var json;
    var req = xmlHttpRequest();
    req.open(method, 'api' + path, true );
    req.setRequestHeader('authorization', auth_header());
    req.setRequestHeader('x-vhost', current_vhost);
    req.onreadystatechange = function () {
        if (req.readyState == 4) {
            var ix = jQuery.inArray(req, outstanding_reqs);
            if (ix != -1) {
                outstanding_reqs.splice(ix, 1);
            }
            if (check_bad_response(req, true)) {
                last_successful_connect = new Date();
                fun(req);
            }
        }
    };
    outstanding_reqs.push(req);
    req.send(body);
}

function sync_get(path) {
    return sync_req('GET', [], path);
}

function sync_put(sammy, path_template) {
    return sync_req('PUT', sammy.params, path_template);
}

function sync_delete(sammy, path_template, options) {
    return sync_req('DELETE', sammy.params, path_template, options);
}

function sync_post(sammy, path_template) {
    return sync_req('POST', sammy.params, path_template);
}

function sync_req(type, params0, path_template, options) {
    var params;
    var path;
    try {
        params = params_magic(params0);
        path = fill_path_template(path_template, params);
    } catch (e) {
        show_popup('warn', fmt_escape_html(e));
        return false;
    }
    var req = xmlHttpRequest();
    req.open(type, 'api' + path, false);
    req.setRequestHeader('content-type', 'application/json');
    req.setRequestHeader('authorization', auth_header());

    if (options != undefined || options != null) {
        if (options.headers != undefined || options.headers != null) {
            jQuery.each(options.headers, function (k, v) {
            req.setRequestHeader(k, v);
            });
        }
    }

    try {
        if (type == 'GET')
            req.send(null);
        else
            req.send(JSON.stringify(params));
    }
    catch (e) {
        if (e.number == 0x80004004) {
            // 0x80004004 means "Operation aborted."
            // http://support.microsoft.com/kb/186063
            // MSIE6 appears to do this in response to HTTP 204.
        }
    }

    if (check_bad_response(req, false)) {
        if (type == 'GET')
            return req.responseText;
        else
            return true;
    }
    else {
        return false;
    }
}

function check_bad_response(req, full_page_404) {
    // 1223 == 204 - see http://www.enhanceie.com/ie/bugs.asp
    // MSIE7 and 8 appear to do this in response to HTTP 204.
    if ((req.status >= 200 && req.status < 300) || req.status == 1223) {
        return true;
    }
    else if (req.status == 404 && full_page_404) {
        var html = format('404', {});
        replace_content('main', html);
    }
    else if (req.status >= 400 && req.status <= 404) {
        var reason = JSON.parse(req.responseText).reason;
        if (typeof(reason) != 'string') reason = JSON.stringify(reason);

        var error = JSON.parse(req.responseText).error;
        if (typeof(error) != 'string') error = JSON.stringify(error);

        if (error == 'bad_request' || error == 'not_found' || error == 'not_authorised') {
            show_popup('warn', fmt_escape_html(reason));
        } else if (error == 'page_out_of_range') {
            var seconds = 60;
            if (last_page_out_of_range_error > 0)
                    seconds = (new Date().getTime() - last_page_out_of_range_error.getTime())/1000;
            if (seconds > 3) {
                 Sammy.log('server reports page is out of range, redirecting to page 1');
                 var contexts = ["queues", "exchanges", "connections", "channels"];
                 var matches = /api\/(.*)\?/.exec(req.responseURL);
                 if (matches != null && matches.length > 1) {
                     contexts.forEach(function(item) {
                         if (matches[1].indexOf(item) == 0) {update_pages(item, 1)};
                     });
                 } else update_pages(current_template, 1);

                 last_page_out_of_range_error = new Date();
            }
        }
    }
    else if (req.status == 408) {
        update_status('timeout');
    }
    else if (req.status == 0) { // Non-MSIE: could not connect
        update_status('error');
    }
    else if (req.status > 12000) { // MSIE: could not connect
        update_status('error');
    }
    else if (req.status == 503) { // Proxy: could not connect
        update_status('error');
    }
    else {
        debug("Management API returned status code " + req.status + " - <strong>" + fmt_escape_html_one_line(req.responseText) + "</strong>");
        clearInterval(timer);
    }

    return false;
}

function fill_path_template(template, params) {
    var re = /:[a-zA-Z_]*/g;
    return template.replace(re, function(m) {
            var str = esc(params[m.substring(1)]);
            if (str == '') {
                throw(m.substring(1) + " is required");
            }
            return str;
        });
}

function params_magic(params) {
    return check_password(maybe_remove_fields(collapse_multifields(params)));
}

function collapse_multifields(params0) {
    function set(x) { return x != '' && x != undefined }

    var params = {};
    var ks = keys(params0);
    var ids = [];
    for (i in ks) {
        var key = ks[i];
        var match = key.match(/([a-z]*)_([0-9_]*)_mftype/);
        var match2 = key.match(/[a-z]*_[0-9_]*_mfkey/);
        var match3 = key.match(/[a-z]*_[0-9_]*_mfvalue/);
        if (match == null && match2 == null && match3 == null) {
            params[key] = params0[key];
        }
        else if (match == null) {
            // Do nothing, value is handled below
        }
        else {
            var name = match[1];
            var id = match[2];
            ids.push([name, id]);
        }
    }
    ids.sort();
    var id_map = {};
    for (i in ids) {
        var name = ids[i][0];
        var id = ids[i][1];
        if (params[name] == undefined) {
            params[name] = {};
            id_map[name] = {};
        }
        var id_parts = id.split('_');
        var k = params0[name + '_' + id_parts[0] + '_mfkey'];
        var v = params0[name + '_' + id + '_mfvalue'];
        var t = params0[name + '_' + id + '_mftype'];
        var val = null;
        var top_level = id_parts.length == 1;
        if (t == 'list') {
            val = [];
            id_map[name][id] = val;
        }
        else if ((set(k) && top_level) || set(v)) {
            if (t == 'boolean') {
                if (v != 'true' && v != 'false')
                    throw(k + ' must be "true" or "false"; got ' + v);
                val = (v == 'true');
            }
            else if (t == 'number') {
                var n = parseFloat(v);
                if (isNaN(n))
                    throw(k + ' must be a number; got ' + v);
                val = n;
            }
            else {
                val = v;
            }
        }
        if (val != null) {
            if (top_level) {
                params[name][k] = val;
            }
            else {
                var prefix = id_parts.slice(0, id_parts.length - 1).join('_');
                id_map[name][prefix].push(val);
            }
        }
    }
    return params;
}

function check_password(params) {
    if (params['password'] != undefined) {
        if (params['password'] == '') {
            throw("Please specify a password.");
        }
        if (params['password'] != params['password_confirm']) {
            throw("Passwords do not match.");
        }
        delete params['password_confirm'];
    }

    return params;
}

function maybe_remove_fields(params) {
    $('.controls-appearance').each(function(index) {
        var options = $(this).get(0).options;
        var selected = $(this).val();

        for (i = 0; i < options.length; i++) {
            var option = options[i].value;
            if (option != selected) {
                delete params[option];
            }
        }
        delete params[$(this).attr('name')];
    });
    return params;
}

function put_parameter(sammy, mandatory_keys, num_keys, bool_keys,
                       arrayable_keys) {
    for (var i in sammy.params) {
        if (i === 'length' || !sammy.params.hasOwnProperty(i)) continue;
        if (sammy.params[i] == '' && jQuery.inArray(i, mandatory_keys) == -1) {
            delete sammy.params[i];
        }
        else if (jQuery.inArray(i, num_keys) != -1) {
            sammy.params[i] = parseInt(sammy.params[i]);
        }
        else if (jQuery.inArray(i, bool_keys) != -1) {
            sammy.params[i] = sammy.params[i] == 'true';
        }
        else if (jQuery.inArray(i, arrayable_keys) != -1) {
            sammy.params[i] = sammy.params[i].split(' ');
            if (sammy.params[i].length == 1) {
                sammy.params[i] = sammy.params[i][0];
            }
        }
    }
    var params = {"component": sammy.params.component,
                  "vhost":     sammy.params.vhost,
                  "name":      sammy.params.name,
                  "value":     params_magic(sammy.params)};
    delete params.value.vhost;
    delete params.value.component;
    delete params.value.name;
    sammy.params = params;
    if (sync_put(sammy, '/parameters/:component/:vhost/:name')) update();
}

function put_policy(sammy, mandatory_keys, num_keys, bool_keys) {
    for (var i in sammy.params) {
        if (i === 'length' || !sammy.params.hasOwnProperty(i)) continue;
        if (sammy.params[i] == '' && jQuery.inArray(i, mandatory_keys) == -1) {
            delete sammy.params[i];
        }
        else if (jQuery.inArray(i, num_keys) != -1) {
            sammy.params[i] = parseInt(sammy.params[i]);
        }
        else if (jQuery.inArray(i, bool_keys) != -1) {
            sammy.params[i] = sammy.params[i] == 'true';
        }
    }
    if (sync_put(sammy, '/policies/:vhost/:name')) update();
}

function update_column_options(sammy) {
    var mode = sammy.params['mode'];
    for (var group in COLUMNS[mode]) {
        var options = COLUMNS[mode][group];
        for (var i = 0; i < options.length; i++) {
            var key = options[i][0];
            var value = sammy.params[mode + '-' + key] != undefined;
            store_pref('column-' + mode + '-' + key, value);
        }
    }

    partial_update();
}

function debug(str) {
    $('<p>' + str + '</p>').appendTo('#debug');
}

function keys(obj) {
    var ks = [];
    for (var k in obj) {
        ks.push(k);
    }
    return ks;
}

// Don't use the jQuery AJAX support, it seems to have trouble reporting
// server-down type errors.
function xmlHttpRequest() {
    var res;
    try {
        res = new XMLHttpRequest();
    }
    catch(e) {
        res = new ActiveXObject("Microsoft.XMLHttp");
    }
    return res;
}

// Our base64 library takes a string that is really a byte sequence,
// and will throw if given a string with chars > 255 (and hence not
// DTRT for chars > 127). So encode a unicode string as a UTF-8
// sequence of "bytes".
function b64_encode_utf8(str) {
    return base64.encode(encode_utf8(str));
}

// encodeURIComponent handles utf-8, unescape does not. Neat!
function encode_utf8(str) {
  return unescape(encodeURIComponent(str));
}

(function($){
    $.fn.extend({
        center: function () {
            return this.each(function() {
                var top = ($(window).height() - $(this).outerHeight()) / 2;
                var left = ($(window).width() - $(this).outerWidth()) / 2;
                $(this).css({margin:0, top: (top > 0 ? top : 0)+'px', left: (left > 0 ? left : 0)+'px'});
            });
        }
    });
})(jQuery);

function debounce(f, delay) {
    var timeout = null;

    return function() {
        var obj = this;
        var args = arguments;

        function delayed () {
            f.apply(obj, args);
            timeout = null;
        }
        if (timeout) clearTimeout(timeout);
        timeout = setTimeout(delayed, delay);
    }
}
        20190718161435       ý                 ¢³      ¢³    ¢³  $ ( d o c u m e n t ) . r e a d y ( f u n c t i o n ( )   { 
         r e p l a c e _ c o n t e n t ( ' o u t e r ' ,   f o r m a t ( ' l o g i n ' ,   { } ) ) ; 
         s t a r t _ a p p _ l o g i n ( ) ; 
 } ) ; 
 
 f u n c t i o n   d i s p a t c h e r _ a d d ( f u n )   { 
         d i s p a t c h e r _ m o d u l e s . p u s h ( f u n ) ; 
         i f   ( d i s p a t c h e r _ m o d u l e s . l e n g t h   = =   e x t e n s i o n _ c o u n t )   { 
                 s t a r t _ a p p ( ) ; 
         } 
 } 
 
 f u n c t i o n   d i s p a t c h e r ( )   { 
         f o r   ( v a r   i   i n   d i s p a t c h e r _ m o d u l e s )   { 
                 d i s p a t c h e r _ m o d u l e s [ i ] ( t h i s ) ; 
         } 
 } 
 
 f u n c t i o n   s e t _ a u t h _ p r e f ( u s e r i n f o )   { 
         / /   c l e a r   a   l o c a l   s t o r a g e   v a l u e   u s e d   b y   e a r l i e r   v e r s i o n s 
         c l e a r _ l o c a l _ p r e f ( ' a u t h ' ) ; 
 
         v a r   b 6 4   =   b 6 4 _ e n c o d e _ u t f 8 ( u s e r i n f o ) ; 
         v a r   d a t e     =   n e w   D a t e ( ) ; 
         / /   8   h o u r s   f r o m   n o w 
         d a t e . s e t H o u r s ( d a t e . g e t H o u r s ( )   +   8 ) ; 
         s t o r e _ c o o k i e _ v a l u e _ w i t h _ e x p i r a t i o n ( ' a u t h ' ,   e n c o d e U R I C o m p o n e n t ( b 6 4 ) ,   d a t e ) ; 
 } 
 
 f u n c t i o n   l o g i n _ r o u t e   ( )   { 
         v a r   u s e r p a s s   =   ' '   +   t h i s . p a r a m s [ ' u s e r n a m e ' ]   +   ' : '   +   t h i s . p a r a m s [ ' p a s s w o r d ' ] , 
                 l o c a t i o n   =   w i n d o w . l o c a t i o n . h r e f , 
                 h a s h   =   w i n d o w . l o c a t i o n . h a s h ; 
         s e t _ a u t h _ p r e f ( d e c o d e U R I C o m p o n e n t ( u s e r p a s s ) ) ; 
         l o c a t i o n   =   l o c a t i o n . s u b s t r ( 0 ,   l o c a t i o n . l e n g t h   -   h a s h . l e n g t h ) ; 
         w i n d o w . l o c a t i o n . r e p l a c e ( l o c a t i o n ) ; 
         / /   b e c a u s e   w e   c h a n g e   u r l ,   w e   d o n ' t   n e e d   t o   h i t   c h e c k _ l o g i n   a s 
         / /   w e ' l l   e n d   u p   d o i n g   t h a t   a t   t h e   b o t t o m   o f   s t a r t _ a p p _ l o g i n   a f t e r 
         / /   w e ' v e   c h a n g e d   u r l . 
 } 
 
 f u n c t i o n   l o g i n _ r o u t e _ w i t h _ p a t h ( )   { 
     v a r   p a r a m s   =   ( ' '   +   t h i s . p a r a m s [ ' s p l a t ' ] ) . s p l i t ( ' / ' ) ; 
     v a r   u s e r   =   p a r a m s . s h i f t ( ) ; 
     v a r   p a s s   =   p a r a m s . s h i f t ( ) ; 
     v a r   u s e r p a s s   =   ' '   +   u s e r   +   ' : '   +   p a s s , 
                 l o c a t i o n   =   w i n d o w . l o c a t i o n . h r e f , 
                 h a s h   =   w i n d o w . l o c a t i o n . h a s h ; 
         s e t _ a u t h _ p r e f ( d e c o d e U R I C o m p o n e n t ( u s e r p a s s ) ) ; 
         l o c a t i o n   =   l o c a t i o n . s u b s t r ( 0 ,   l o c a t i o n . l e n g t h   -   h a s h . l e n g t h )   +   ' # / '   +   p a r a m s . j o i n ( ' / ' ) ; 
         c h e c k _ l o g i n ( ) ; 
         w i n d o w . l o c a t i o n . r e p l a c e ( l o c a t i o n ) ; 
 } 
 
 f u n c t i o n   s t a r t _ a p p _ l o g i n ( )   { 
         a p p   =   n e w   S a m m y . A p p l i c a t i o n ( f u n c t i o n   ( )   { 
                 t h i s . g e t ( ' # / ' ,   f u n c t i o n ( )   { } ) ; 
                 t h i s . p u t ( ' # / l o g i n ' ,   f u n c t i o n ( )   { 
                         u s e r n a m e   =   t h i s . p a r a m s [ ' u s e r n a m e ' ] ; 
                         p a s s w o r d   =   t h i s . p a r a m s [ ' p a s s w o r d ' ] ; 
                         s e t _ a u t h _ p r e f ( u s e r n a m e   +   ' : '   +   p a s s w o r d ) ; 
                         c h e c k _ l o g i n ( ) ; 
                 } ) ; 
                 t h i s . g e t ( ' # / l o g i n / : u s e r n a m e / : p a s s w o r d ' ,   l o g i n _ r o u t e ) ; 
                 t h i s . g e t ( / \ # \ / l o g i n \ / ( . * ) / ,   l o g i n _ r o u t e _ w i t h _ p a t h ) ; 
         } ) ; 
         a p p . r u n ( ) ; 
         i f   ( g e t _ c o o k i e _ v a l u e ( ' a u t h ' )   ! =   n u l l )   { 
                 c h e c k _ l o g i n ( ) ; 
         } 
 } 
 
 f u n c t i o n   c h e c k _ l o g i n ( )   { 
         u s e r   =   J S O N . p a r s e ( s y n c _ g e t ( ' / w h o a m i ' ) ) ; 
         i f   ( u s e r   = =   f a l s e )   { 
                 / /   c l e a r   a   l o c a l   s t o r a g e   v a l u e   u s e d   b y   e a r l i e r   v e r s i o n s 
                 c l e a r _ p r e f ( ' a u t h ' ) ; 
                 c l e a r _ c o o k i e _ v a l u e ( ' a u t h ' ) ; 
                 r e p l a c e _ c o n t e n t ( ' l o g i n - s t a t u s ' ,   ' < p > L o g i n   f a i l e d < / p > ' ) ; 
         } 
         e l s e   { 
                 r e p l a c e _ c o n t e n t ( ' o u t e r ' ,   f o r m a t ( ' l a y o u t ' ,   { } ) ) ; 
                 s e t u p _ g l o b a l _ v a r s ( ) ; 
                 s e t u p _ c o n s t a n t _ e v e n t s ( ) ; 
                 u p d a t e _ v h o s t s ( ) ; 
                 u p d a t e _ i n t e r v a l ( ) ; 
                 s e t u p _ e x t e n s i o n s ( ) ; 
         } 
 } 
 
 f u n c t i o n   s t a r t _ a p p ( )   { 
         i f   ( a p p   ! = =   u n d e f i n e d )   { 
                 a p p . u n l o a d ( ) ; 
         } 
         / /   O h   b o y .   S a m m y   u s e s   v a r i o u s   d i f f e r e n t   m e t h o d s   t o   d e t e r m i n e   i f 
         / /   t h e   U R L   h a s h   h a s   c h a n g e d .   U n s u r p r i s i n g l y   t h i s   i s   a   n a t i v e   e v e n t 
         / /   i n   m o d e r n   b r o w s e r s ,   a n d   f a l l s   b a c k   t o   a n   i c k y   p o l l i n g   f u n c t i o n 
         / /   i n   M S I E .   B u t   i t   l o o k s   l i k e   t h e r e ' s   a   b u g .   T h e   p o l l i n g   f u n c t i o n 
         / /   s h o u l d   g e t   i n s t a l l e d   w h e n   t h e   a p p   i s   s t a r t e d .   B u t   i t ' s   g u a r d e d 
         / /   b e h i n d   i f   ( S a m m y . H a s h L o c a t i o n P r o x y . _ i n t e r v a l   ! =   n u l l ) .   A n d   o f 
         / /   c o u r s e   t h a t ' s   n o t   s p e c i f i c   t o   t h e   a p p l i c a t i o n ;   i t ' s   p r e t t y 
         / /   g l o b a l .   S o   w e   n e e d   t o   m a n u a l l y   c l e a r   t h a t   i n   o r d e r   f o r   l i n k s   t o 
         / /   w o r k   i n   M S I E . 
         / /   F i l e d   a s   h t t p s : / / g i t h u b . c o m / q u i r k e y / s a m m y / i s s u e s / 1 7 1 
         / / 
         / /   N o t e   f o r   w h e n   w e   u p g r a d e :   H a s h L o c a t i o n P r o x y   h a s   b e c o m e 
         / /   D e f a u l t L o c a t i o n P r o x y   i n   l a t e r   v e r s i o n s ,   b u t   o t h e r w i s e   t h e   i s s u e 
         / /   r e m a i n s . 
 
         / /   u p d a t e d   t o   t h e   v e r s i o n     0 . 7 . 6   t h i s   _ i n t e r v a l   =   n u l l   i s   f i x e d 
         / /   j u s t   l e a v e   t h e   h i s t o r y   h e r e . 
         / / S a m m y . H a s h L o c a t i o n P r o x y . _ i n t e r v a l   =   n u l l ; 
 
 
         a p p   =   n e w   S a m m y . A p p l i c a t i o n ( d i s p a t c h e r ) ; 
         a p p . r u n ( ) ; 
         v a r   u r l   =   t h i s . l o c a t i o n . t o S t r i n g ( ) ; 
         i f   ( u r l . i n d e x O f ( ' # ' )   = =   - 1 )   { 
                 t h i s . l o c a t i o n   =   u r l   +   ' # / ' ; 
         } 
 } 
 
 f u n c t i o n   s e t u p _ c o n s t a n t _ e v e n t s ( )   { 
         $ ( ' # u p d a t e - e v e r y ' ) . c h a n g e ( f u n c t i o n ( )   { 
                         v a r   i n t e r v a l   =   $ ( t h i s ) . v a l ( ) ; 
                         s t o r e _ p r e f ( ' i n t e r v a l ' ,   i n t e r v a l ) ; 
                         i f   ( i n t e r v a l   = =   ' ' ) 
                                 i n t e r v a l   =   n u l l ; 
                         e l s e 
                                 i n t e r v a l   =   p a r s e I n t ( i n t e r v a l ) ; 
                         s e t _ t i m e r _ i n t e r v a l ( i n t e r v a l ) ; 
                 } ) ; 
         $ ( ' # s h o w - v h o s t ' ) . c h a n g e ( f u n c t i o n ( )   { 
                         c u r r e n t _ v h o s t   =   $ ( t h i s ) . v a l ( ) ; 
                         s t o r e _ p r e f ( ' v h o s t ' ,   c u r r e n t _ v h o s t ) ; 
                         u p d a t e ( ) ; 
                 } ) ; 
         i f   ( ! v h o s t s _ i n t e r e s t i n g )   { 
                 $ ( ' # v h o s t - f o r m ' ) . h i d e ( ) ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ v h o s t s ( )   { 
         v a r   v h o s t s   =   J S O N . p a r s e ( s y n c _ g e t ( ' / v h o s t s ' ) ) ; 
         v h o s t s _ i n t e r e s t i n g   =   v h o s t s . l e n g t h   >   1 ; 
         i f   ( v h o s t s _ i n t e r e s t i n g ) 
                 $ ( ' # v h o s t - f o r m ' ) . s h o w ( ) ; 
         e l s e 
                 $ ( ' # v h o s t - f o r m ' ) . h i d e ( ) ; 
         v a r   s e l e c t   =   $ ( ' # s h o w - v h o s t ' ) . g e t ( 0 ) ; 
         s e l e c t . o p t i o n s . l e n g t h   =   v h o s t s . l e n g t h   +   1 ; 
         v a r   i n d e x   =   0 ; 
         f o r   ( v a r   i   =   0 ;   i   <   v h o s t s . l e n g t h ;   i + + )   { 
                 v a r   v h o s t   =   v h o s t s [ i ] . n a m e ; 
                 s e l e c t . o p t i o n s [ i   +   1 ]   =   n e w   O p t i o n ( v h o s t ,   v h o s t ) ; 
                 i f   ( v h o s t   = =   c u r r e n t _ v h o s t )   i n d e x   =   i   +   1 ; 
         } 
         s e l e c t . s e l e c t e d I n d e x   =   i n d e x ; 
         c u r r e n t _ v h o s t   =   s e l e c t . o p t i o n s [ i n d e x ] . v a l u e ; 
         s t o r e _ p r e f ( ' v h o s t ' ,   c u r r e n t _ v h o s t ) ; 
 } 
 
 f u n c t i o n   s e t u p _ e x t e n s i o n s ( )   { 
         v a r   e x t e n s i o n s   =   J S O N . p a r s e ( s y n c _ g e t ( ' / e x t e n s i o n s ' ) ) ; 
         e x t e n s i o n _ c o u n t   =   0 ; 
         f o r   ( v a r   i   i n   e x t e n s i o n s )   { 
                 v a r   e x t e n s i o n   =   e x t e n s i o n s [ i ] ; 
                 i f   ( $ . i s P l a i n O b j e c t ( e x t e n s i o n )   & &   e x t e n s i o n . h a s O w n P r o p e r t y ( " j a v a s c r i p t " ) )   { 
                         d y n a m i c _ l o a d ( e x t e n s i o n . j a v a s c r i p t ) ; 
                         e x t e n s i o n _ c o u n t + + ; 
                 } 
         } 
 } 
 
 f u n c t i o n   d y n a m i c _ l o a d ( f i l e n a m e )   { 
         v a r   e l e m e n t   =   d o c u m e n t . c r e a t e E l e m e n t ( ' s c r i p t ' ) ; 
         e l e m e n t . s e t A t t r i b u t e ( ' t y p e ' ,   ' t e x t / j a v a s c r i p t ' ) ; 
         e l e m e n t . s e t A t t r i b u t e ( ' s r c ' ,   ' j s / '   +   f i l e n a m e ) ; 
         d o c u m e n t . g e t E l e m e n t s B y T a g N a m e ( " h e a d " ) [ 0 ] . a p p e n d C h i l d ( e l e m e n t ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ i n t e r v a l ( )   { 
         v a r   i n t e r v a l S t r   =   g e t _ p r e f ( ' i n t e r v a l ' ) ; 
         v a r   i n t e r v a l ; 
 
         i f   ( i n t e r v a l S t r   = =   n u l l )         i n t e r v a l   =   5 0 0 0 ; 
         e l s e   i f   ( i n t e r v a l S t r   = =   ' ' )   i n t e r v a l   =   n u l l ; 
         e l s e                                                 i n t e r v a l   =   p a r s e I n t ( i n t e r v a l S t r ) ; 
 
         i f   ( i s N a N ( i n t e r v a l ) )   i n t e r v a l   =   n u l l ;   / /   P r e v e n t   D o S   i f   c o o k i e   m a l f o r m e d 
 
         s e t _ t i m e r _ i n t e r v a l ( i n t e r v a l ) ; 
 
         v a r   s e l e c t   =   $ ( ' # u p d a t e - e v e r y ' ) . g e t ( 0 ) ; 
         v a r   o p t s   =   s e l e c t . o p t i o n s ; 
         f o r   ( v a r   i   =   0 ;   i   <   o p t s . l e n g t h ;   i + + )   { 
                 i f   ( o p t s [ i ] . v a l u e   = =   i n t e r v a l S t r )   { 
                         s e l e c t . s e l e c t e d I n d e x   =   i ; 
                         b r e a k ; 
                 } 
         } 
 } 
 
 f u n c t i o n   g o _ t o ( u r l )   { 
         t h i s . l o c a t i o n   =   u r l ; 
 } 
 
 f u n c t i o n   s e t _ t i m e r _ i n t e r v a l ( i n t e r v a l )   { 
         t i m e r _ i n t e r v a l   =   i n t e r v a l ; 
         r e s e t _ t i m e r ( ) ; 
 } 
 
 f u n c t i o n   r e s e t _ t i m e r ( )   { 
         c l e a r I n t e r v a l ( t i m e r ) ; 
         i f   ( t i m e r _ i n t e r v a l   ! =   n u l l )   { 
                 t i m e r   =   s e t I n t e r v a l ( p a r t i a l _ u p d a t e ,   t i m e r _ i n t e r v a l ) ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ m a n u a l ( d i v ,   q u e r y )   { 
         v a r   p a t h ; 
         v a r   t e m p l a t e ; 
         i f   ( q u e r y   = =   ' m e m o r y '   | |   q u e r y   = =   ' b i n a r y ' )   { 
                 p a t h   =   c u r r e n t _ r e q s [ ' n o d e ' ] [ ' p a t h ' ]   +   ' ? '   +   q u e r y   +   ' = t r u e ' ; 
                 t e m p l a t e   =   q u e r y ; 
         } 
         v a r   d a t a   =   J S O N . p a r s e ( s y n c _ g e t ( p a t h ) ) ; 
 
         r e p l a c e _ c o n t e n t ( d i v ,   f o r m a t ( t e m p l a t e ,   d a t a ) ) ; 
         p o s t p r o c e s s _ p a r t i a l ( ) ; 
 } 
 
 f u n c t i o n   r e n d e r ( r e q s ,   t e m p l a t e ,   h i g h l i g h t )   { 
         c u r r e n t _ t e m p l a t e   =   t e m p l a t e ; 
         c u r r e n t _ r e q s   =   r e q s ; 
         f o r   ( v a r   i   i n   o u t s t a n d i n g _ r e q s )   { 
                 o u t s t a n d i n g _ r e q s [ i ] . a b o r t ( ) ; 
         } 
         o u t s t a n d i n g _ r e q s   =   [ ] ; 
         c u r r e n t _ h i g h l i g h t   =   h i g h l i g h t ; 
         u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   u p d a t e ( )   { 
         r e p l a c e _ c o n t e n t ( ' d e b u g ' ,   ' ' ) ; 
         c l e a r I n t e r v a l ( t i m e r ) ; 
         w i t h _ u p d a t e ( f u n c t i o n ( h t m l )   { 
                         u p d a t e _ n a v i g a t i o n ( ) ; 
                         r e p l a c e _ c o n t e n t ( ' m a i n ' ,   h t m l ) ; 
                         p o s t p r o c e s s ( ) ; 
                         p o s t p r o c e s s _ p a r t i a l ( ) ; 
                         r e n d e r _ c h a r t s ( ) ; 
                         m a y b e _ s c r o l l ( ) ; 
                         r e s e t _ t i m e r ( ) ; 
                 } ) ; 
 } 
 
 f u n c t i o n   p a r t i a l _ u p d a t e ( )   { 
         i f   ( ! $ ( " . p a g i n a t i o n _ c l a s s " ) . i s ( " : f o c u s " ) )   { 
                 i f   ( $ ( ' . u p d a t a b l e ' ) . l e n g t h   >   0 )   { 
                         i f   ( u p d a t e _ c o u n t e r   > =   2 0 0 )   { 
                                 u p d a t e _ c o u n t e r   =   0 ; 
                                 f u l l _ r e f r e s h ( ) ; 
                                 r e t u r n ; 
                         } 
                         w i t h _ u p d a t e ( f u n c t i o n ( h t m l )   { 
                                 u p d a t e _ c o u n t e r + + ; 
                                 r e p l a c e _ c o n t e n t ( ' s c r a t c h ' ,   h t m l ) ; 
                                 v a r   b e f o r e s   =   $ ( ' # m a i n   . u p d a t a b l e ' ) ; 
                                 v a r   a f t e r s   =   $ ( ' # s c r a t c h   . u p d a t a b l e ' ) ; 
                                 i f   ( b e f o r e s . l e n g t h   ! =   a f t e r s . l e n g t h )   { 
                                         c o n s o l e . l o g ( " b e f o r e / a f t e r   m i s m a t c h !   D o i n g   a   f u l l   r e l o a d . . . " ) ; 
                                         f u l l _ r e f r e s h ( ) ; 
                                 } 
                                 f o r   ( v a r   i   =   0 ;   i   <   b e f o r e s . l e n g t h ;   i + + )   { 
                                         $ ( b e f o r e s [ i ] ) . e m p t y ( ) . a p p e n d ( $ ( a f t e r s [ i ] ) . c o n t e n t s ( ) ) ; 
                                 } 
                                 r e p l a c e _ c o n t e n t ( ' s c r a t c h ' ,   ' ' ) ; 
                                 p o s t p r o c e s s _ p a r t i a l ( ) ; 
                                 r e n d e r _ c h a r t s ( ) ; 
                         } ) ; 
                 } 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ n a v i g a t i o n ( )   { 
         v a r   l 1   =   ' ' ; 
         v a r   l 2   =   ' ' ; 
         v a r   d e s c e n d   =   n u l l ; 
 
         f o r   ( v a r   k   i n   N A V I G A T I O N )   { 
                 v a r   v a l   =   N A V I G A T I O N [ k ] ; 
                 v a r   p a t h   =   v a l ; 
                 w h i l e   ( ! l e a f ( p a t h ) )   { 
                         p a t h   =   f i r s t _ s h o w a b l e _ c h i l d ( p a t h ) ; 
                 } 
                 v a r   s e l e c t e d   =   f a l s e ; 
                 i f   ( c o n t a i n s _ c u r r e n t _ h i g h l i g h t ( v a l ) )   { 
                         s e l e c t e d   =   t r u e ; 
                         i f   ( ! l e a f ( v a l ) )   { 
                                 d e s c e n d   =   n a v ( v a l ) ; 
                         } 
                 } 
                 i f   ( s h o w ( p a t h ) )   { 
                         l 1   + =   ' < l i > < a   h r e f = " '   +   n a v ( p a t h )   +   ' " '   + 
                                 ( s e l e c t e d   ?   '   c l a s s = " s e l e c t e d " '   :   ' ' )   +   ' > '   +   k   +   ' < / a > < / l i > ' ; 
                 } 
         } 
 
         i f   ( d e s c e n d )   { 
                 l 2   =   o b j _ t o _ u l ( d e s c e n d ) ; 
                 $ ( ' # m a i n ' ) . a d d C l a s s ( ' w i t h - r h s ' ) ; 
         } 
         e l s e   { 
                 $ ( ' # m a i n ' ) . r e m o v e C l a s s ( ' w i t h - r h s ' ) ; 
         } 
 
         r e p l a c e _ c o n t e n t ( ' t a b s ' ,   l 1 ) ; 
         r e p l a c e _ c o n t e n t ( ' r h s ' ,   l 2 ) ; 
 } 
 
 f u n c t i o n   n a v ( p a i r )   { 
         r e t u r n   p a i r [ 0 ] ; 
 } 
 
 f u n c t i o n   s h o w ( p a i r )   { 
         r e t u r n   j Q u e r y . i n A r r a y ( p a i r [ 1 ] ,   u s e r _ t a g s )   ! =   - 1 ; 
 } 
 
 f u n c t i o n   l e a f ( p a i r )   { 
         r e t u r n   t y p e o f ( n a v ( p a i r ) )   = =   ' s t r i n g ' ; 
 } 
 
 f u n c t i o n   f i r s t _ s h o w a b l e _ c h i l d ( p a i r )   { 
         v a r   i t e m s   =   p a i r [ 0 ] ; 
         v a r   k s   =   k e y s ( i t e m s ) ; 
         f o r   ( v a r   i   =   0 ;   i   <   k s . l e n g t h ;   i + + )   { 
                 v a r   c h i l d   =   i t e m s [ k s [ i ] ] ; 
                 i f   ( s h o w ( c h i l d ) )   r e t u r n   c h i l d ; 
         } 
         r e t u r n   i t e m s [ k s [ 0 ] ] ;   / /   W e ' l l   e n d   u p   n o t   s h o w i n g   i t   a n y w a y 
 } 
 
 f u n c t i o n   c o n t a i n s _ c u r r e n t _ h i g h l i g h t ( v a l )   { 
         i f   ( l e a f ( v a l ) )   { 
                 r e t u r n   c u r r e n t _ h i g h l i g h t   = =   n a v ( v a l ) ; 
         } 
         e l s e   { 
                 v a r   b   =   f a l s e ; 
                 f o r   ( v a r   k   i n   v a l )   { 
                         b   | =   c o n t a i n s _ c u r r e n t _ h i g h l i g h t ( v a l [ k ] ) ; 
                 } 
                 r e t u r n   b ; 
         } 
 } 
 
 f u n c t i o n   o b j _ t o _ u l ( v a l )   { 
         v a r   r e s   =   ' < u l > ' ; 
         f o r   ( v a r   k   i n   v a l )   { 
                 v a r   o b j   =   v a l [ k ] ; 
                 i f   ( s h o w ( o b j ) )   { 
                         r e s   + =   ' < l i > ' ; 
                         i f   ( l e a f ( o b j ) )   { 
                                 r e s   + =   ' < a   h r e f = " '   +   n a v ( o b j )   +   ' " '   + 
                                         ( c u r r e n t _ h i g h l i g h t   = =   n a v ( o b j )   ?   '   c l a s s = " s e l e c t e d " '   :   ' ' )   + 
                                         ' > '   +   k   +   ' < / a > ' ; 
                         } 
                         e l s e   { 
                                 r e s   + =   o b j _ t o _ u l ( n a v ( o b j ) ) ; 
                         } 
                         r e s   + =   ' < / l i > ' ; 
                 } 
         } 
         r e t u r n   r e s   +   ' < / u l > ' ; 
 } 
 
 f u n c t i o n   f u l l _ r e f r e s h ( )   { 
         s t o r e _ p r e f ( ' p o s i t i o n ' ,   x _ p o s i t i o n ( )   +   ' , '   +   y _ p o s i t i o n ( ) ) ; 
         l o c a t i o n . r e l o a d ( ) ; 
 } 
 
 f u n c t i o n   m a y b e _ s c r o l l ( )   { 
         v a r   p o s   =   g e t _ p r e f ( ' p o s i t i o n ' ) ; 
         i f   ( p o s )   { 
                 c l e a r _ p r e f ( ' p o s i t i o n ' ) ; 
                 v a r   x y   =   p o s . s p l i t ( " , " ) ; 
                 w i n d o w . s c r o l l T o ( p a r s e I n t ( x y [ 0 ] ) ,   p a r s e I n t ( x y [ 1 ] ) ) ; 
         } 
 } 
 
 f u n c t i o n   x _ p o s i t i o n ( )   { 
         r e t u r n   w i n d o w . p a g e X O f f s e t   ? 
                 w i n d o w . p a g e X O f f s e t   : 
                 d o c u m e n t . d o c u m e n t E l e m e n t . s c r o l l L e f t   ? 
                 d o c u m e n t . d o c u m e n t E l e m e n t . s c r o l l L e f t   : 
                 d o c u m e n t . b o d y . s c r o l l L e f t ; 
 } 
 
 f u n c t i o n   y _ p o s i t i o n ( )   { 
         r e t u r n   w i n d o w . p a g e Y O f f s e t   ? 
                 w i n d o w . p a g e Y O f f s e t   : 
                 d o c u m e n t . d o c u m e n t E l e m e n t . s c r o l l T o p   ? 
                 d o c u m e n t . d o c u m e n t E l e m e n t . s c r o l l T o p   : 
                 d o c u m e n t . b o d y . s c r o l l T o p ; 
 } 
 
 f u n c t i o n   w i t h _ u p d a t e ( f u n )   { 
         i f ( o u t s t a n d i n g _ r e q s . l e n g t h   >   0 ) { 
                 r e t u r n   f a l s e ; 
         } 
         w i t h _ r e q s ( a p p l y _ s t a t e ( c u r r e n t _ r e q s ) ,   [ ] ,   f u n c t i o n ( j s o n )   { 
                         v a r   h t m l   =   f o r m a t ( c u r r e n t _ t e m p l a t e ,   j s o n ) ; 
                         f u n ( h t m l ) ; 
                         u p d a t e _ s t a t u s ( ' o k ' ) ; 
                 } ) ; 
         r e t u r n   t r u e ; 
 } 
 
 f u n c t i o n   a p p l y _ s t a t e ( r e q s )   { 
         v a r   r e q s 2   =   { } ; 
         f o r   ( k   i n   r e q s )   { 
                 v a r   r e q   =   r e q s [ k ] ; 
                 v a r   o p t i o n s   =   { } ; 
                 i f   ( t y p e o f ( r e q )   = =   " o b j e c t " )   { 
                         o p t i o n s   =   r e q . o p t i o n s ; 
                         r e q   =   r e q . p a t h ; 
                 } 
                 v a r   r e q 2 ; 
                 i f   ( o p t i o n s [ ' v h o s t ' ]   ! =   u n d e f i n e d   & &   c u r r e n t _ v h o s t   ! =   ' ' )   { 
                         v a r   i n d e x P a g e   =   r e q . i n d e x O f ( " ? p a g e = " ) ; 
                         i f   ( i n d e x P a g e   > -   1 )   { 
 	 	 	 	 p a g e U r l   =   r e q . s u b s t r ( i n d e x P a g e ) ; 
 	 	 	 	 r e q 2   =   r e q . s u b s t r ( 0 , i n d e x P a g e )   +   ' / '   +   e s c ( c u r r e n t _ v h o s t )   +   p a g e U r l ; 
                         }   e l s e 
 
                             r e q 2   =   r e q   +   ' / '   +   e s c ( c u r r e n t _ v h o s t ) ; 
                 } 
                 e l s e   { 
                         r e q 2   =   r e q ; 
                 } 
                 v a r   q s   =   [ ] ; 
                 i f   ( o p t i o n s [ ' s o r t ' ]   ! =   u n d e f i n e d   & &   c u r r e n t _ s o r t   ! =   n u l l )   { 
                         q s . p u s h ( ' s o r t = '   +   c u r r e n t _ s o r t ) ; 
                         q s . p u s h ( ' s o r t _ r e v e r s e = '   +   c u r r e n t _ s o r t _ r e v e r s e ) ; 
                 } 
                 i f   ( o p t i o n s [ ' r a n g e s ' ]   ! =   u n d e f i n e d )   { 
                         f o r   ( i   i n   o p t i o n s [ ' r a n g e s ' ] )   { 
                                 v a r   t y p e   =   o p t i o n s [ ' r a n g e s ' ] [ i ] ; 
                                 v a r   r a n g e   =   g e t _ p r e f ( ' c h a r t - r a n g e ' ) . s p l i t ( ' | ' ) ; 
                                 v a r   p r e f i x ; 
                                 i f   ( t y p e . s u b s t r i n g ( 0 ,   8 )   = =   ' l e n g t h s - ' )   { 
                                         p r e f i x   =   ' l e n g t h s ' ; 
                                 } 
                                 e l s e   i f   ( t y p e . s u b s t r i n g ( 0 ,   1 0 )   = =   ' m s g - r a t e s - ' )   { 
                                         p r e f i x   =   ' m s g _ r a t e s ' ; 
                                 } 
                                 e l s e   i f   ( t y p e . s u b s t r i n g ( 0 ,   1 1 )   = =   ' d a t a - r a t e s - ' )   { 
                                         p r e f i x   =   ' d a t a _ r a t e s ' ; 
                                 } 
                                 e l s e   i f   ( t y p e   = =   ' n o d e - s t a t s ' )   { 
                                         p r e f i x   =   ' n o d e _ s t a t s ' ; 
                                 } 
                                 q s . p u s h ( p r e f i x   +   ' _ a g e = '   +   p a r s e I n t ( r a n g e [ 0 ] ) ) ; 
                                 q s . p u s h ( p r e f i x   +   ' _ i n c r = '   +   p a r s e I n t ( r a n g e [ 1 ] ) ) ; 
                         } 
                 } 
                 / *   U n k n o w n   o p t i o n s   a r e   u s e d   a s   q u e r y   p a r a m e t e r s   a s   i s .   * / 
                 O b j e c t . k e y s ( o p t i o n s ) . f o r E a c h ( f u n c t i o n   ( k e y )   { 
                     / *   S k i p   k n o w n   k e y s   w e   a l r e a d y   h a n d l e d   a n d   u n d e f i n e d   p a r a m e t e r s .   * / 
                     i f   ( k e y   = =   ' v h o s t '   | |   k e y   = =   ' s o r t '   | |   k e y   = =   ' r a n g e s ' ) 
                         r e t u r n ; 
                     i f   ( ! k e y   | |   o p t i o n s [ k e y ]   = =   u n d e f i n e d ) 
                         r e t u r n ; 
 
                     q s . p u s h ( e s c ( k e y )   +   ' = '   +   e s c ( o p t i o n s [ k e y ] ) ) ; 
                 } ) ; 
                 q s   =   q s . j o i n ( ' & ' ) ; 
                 i f   ( q s   ! =   ' ' ) 
                         i f   ( r e q 2 . i n d e x O f ( " ? p a g e = " )   > -   1 ) 
                         q s   =   ' & '   +   q s ; 
                           e l s e 
                         q s   =   ' ? '   +   q s ; 
 
                 r e q s 2 [ k ]   =   r e q 2   +   q s ; 
         } 
         r e t u r n   r e q s 2 ; 
 } 
 
 f u n c t i o n   s h o w _ p o p u p ( t y p e ,   t e x t ,   _ m o d e )   { 
         v a r   c s s C l a s s   =   ' . f o r m - p o p u p - '   +   t y p e ; 
         f u n c t i o n   h i d e ( )   { 
                 $ ( c s s C l a s s ) . f a d e O u t ( 1 0 0 ,   f u n c t i o n ( )   { 
                         $ ( t h i s ) . r e m o v e ( ) ; 
                 } ) ; 
         } 
         h i d e ( ) ; 
         $ ( ' # o u t e r ' ) . a f t e r ( f o r m a t ( ' p o p u p ' ,   { ' t y p e ' :   t y p e ,   ' t e x t ' :   t e x t } ) ) ; 
         $ ( c s s C l a s s ) . f a d e I n ( 1 0 0 ) ; 
         $ ( c s s C l a s s   +   '   s p a n ' ) . c l i c k ( f u n c t i o n   ( )   { 
                 $ ( ' . p o p u p - o w n e r ' ) . r e m o v e C l a s s ( ' p o p u p - o w n e r ' ) ; 
                 h i d e ( ) ; 
         } ) ; 
 } 
 
 f u n c t i o n   s u b m i t _ i m p o r t ( f o r m )   { 
         i f   ( f o r m . f i l e . v a l u e )   { 
                 v a r   c o n f i r m _ u p l o a d   =   c o n f i r m ( ' A r e   y o u   s u r e   y o u   w a n t   t o   i m p o r t   a   d e f i n i t i o n s   f i l e ?   S o m e   e n t i t i e s   ( v h o s t s ,   u s e r s ,   q u e u e s ,   e t c )   m a y   b e   o v e r w r i t t e n ! ' ) ; 
                 i f   ( c o n f i r m _ u p l o a d   = = =   t r u e )   { 
                         v a r   i d x   =   $ ( " s e l e c t [ n a m e = ' v h o s t - u p l o a d ' ]   o p t i o n : s e l e c t e d " ) . i n d e x ( ) ; 
                         v a r   v h o s t   =   ( ( i d x   < =   0 )   ?   " "   :   " / "   +   e s c ( $ ( " s e l e c t [ n a m e = ' v h o s t - u p l o a d ' ]   o p t i o n : s e l e c t e d " ) . v a l ( ) ) ) ; 
                         f o r m . a c t i o n   = " a p i / d e f i n i t i o n s "   +   v h o s t   +   ' ? a u t h = '   +   g e t _ c o o k i e _ v a l u e ( ' a u t h ' ) ; 
                         f o r m . s u b m i t ( ) ; 
                         w i n d o w . l o c a t i o n . r e p l a c e ( " . . / . . / # / i m p o r t - s u c c e e d e d " ) ; 
                 }   e l s e   { 
                         r e t u r n   f a l s e ; 
                 } 
         }   e l s e   { 
                 r e t u r n   f a l s e ; 
         } 
 } ; 
 
 f u n c t i o n   p o s t p r o c e s s ( )   { 
         $ ( ' f o r m . c o n f i r m - q u e u e ' ) . s u b m i t ( f u n c t i o n ( )   { 
                 r e t u r n   c o n f i r m ( " A r e   y o u   s u r e ?   T h e   q u e u e   i s   g o i n g   t o   b e   d e l e t e d .   "   + 
                                               " M e s s a g e s   c a n n o t   b e   r e c o v e r e d   a f t e r   d e l e t i o n . " ) ; 
                 } ) ; 
 
         $ ( ' f o r m . c o n f i r m - p u r g e - q u e u e ' ) . s u b m i t ( f u n c t i o n ( )   { 
                 r e t u r n   c o n f i r m ( " A r e   y o u   s u r e ?   M e s s a g e s   c a n n o t   b e   r e c o v e r e d   a f t e r   p u r g i n g . " ) ; 
                 } ) ; 
 
         $ ( ' f o r m . c o n f i r m ' ) . s u b m i t ( f u n c t i o n ( )   { 
                         r e t u r n   c o n f i r m ( " A r e   y o u   s u r e ?   T h i s   o b j e c t   c a n n o t   b e   r e c o v e r e d   "   + 
                                                       " a f t e r   d e l e t i o n . " ) ; 
                 } ) ; 
 
         $ ( ' l a b e l ' ) . m a p ( f u n c t i o n ( )   { 
                         i f   ( $ ( t h i s ) . a t t r ( ' f o r ' )   = =   ' ' )   { 
                                 v a r   i d   =   ' a u t o - l a b e l - '   +   M a t h . f l o o r ( M a t h . r a n d o m ( ) * 1 0 0 0 0 0 0 0 0 0 ) ; 
                                 v a r   i n p u t   =   $ ( t h i s ) . p a r e n t s ( ' t r ' ) . f i r s t ( ) . f i n d ( ' i n p u t ,   s e l e c t ' ) ; 
                                 i f   ( i n p u t . a t t r ( ' i d ' )   = =   ' ' )   { 
                                         $ ( t h i s ) . a t t r ( ' f o r ' ,   i d ) ; 
                                         i n p u t . a t t r ( ' i d ' ,   i d ) ; 
                                 } 
                         } 
                 } ) ; 
 
         $ ( ' # d o w n l o a d - d e f i n i t i o n s ' ) . c l i c k ( f u n c t i o n ( )   { 
                         v a r   i d x   =   $ ( " s e l e c t [ n a m e = ' v h o s t - d o w n l o a d ' ]   o p t i o n : s e l e c t e d " ) . i n d e x ( ) ; 
                         v a r   v h o s t   =   ( ( i d x   < = 0   )   ?   " "   :   " / "   +   e s c ( $ ( " s e l e c t [ n a m e = ' v h o s t - d o w n l o a d ' ]   o p t i o n : s e l e c t e d " ) . v a l ( ) ) ) ; 
                         v a r   p a t h   =   ' a p i / d e f i n i t i o n s '   +   v h o s t   +   ' ? d o w n l o a d = '   + 
                                 e s c ( $ ( ' # d o w n l o a d - f i l e n a m e ' ) . v a l ( ) )   + 
                                 ' & a u t h = '   +   g e t _ c o o k i e _ v a l u e ( ' a u t h ' ) ; 
                         w i n d o w . l o c a t i o n   =   p a t h ; 
                         s e t T i m e o u t ( ' a p p . r u n ( ) ' ) ; 
                         r e t u r n   f a l s e ; 
                 } ) ; 
 
         $ ( ' . u p d a t e - m a n u a l ' ) . c l i c k ( f u n c t i o n ( )   { 
                         u p d a t e _ m a n u a l ( $ ( t h i s ) . a t t r ( ' f o r ' ) ,   $ ( t h i s ) . a t t r ( ' q u e r y ' ) ) ; 
                 } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' k e y u p ' ,   ' . m u l t i f i e l d   i n p u t ' ,   f u n c t i o n ( )   { 
                         u p d a t e _ m u l t i f i e l d s ( ) ; 
                 } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' c h a n g e ' ,   ' . m u l t i f i e l d   s e l e c t ' ,   f u n c t i o n ( )   { 
                         u p d a t e _ m u l t i f i e l d s ( ) ; 
                 } ) ; 
 
         $ ( ' . c o n t r o l s - a p p e a r a n c e ' ) . c h a n g e ( f u n c t i o n ( )   { 
                 v a r   p a r a m s   =   $ ( t h i s ) . g e t ( 0 ) . o p t i o n s ; 
                 v a r   s e l e c t e d   =   $ ( t h i s ) . v a l ( ) ; 
 
                 f o r   ( i   =   0 ;   i   <   p a r a m s . l e n g t h ;   i + + )   { 
                         v a r   p a r a m   =   p a r a m s [ i ] . v a l u e ; 
                         i f   ( p a r a m   = =   s e l e c t e d )   { 
                                 $ ( ' # '   +   p a r a m   +   ' - d i v ' ) . s l i d e D o w n ( 1 0 0 ) ; 
                         }   e l s e   { 
                                 $ ( ' # '   +   p a r a m   +   ' - d i v ' ) . s l i d e U p ( 1 0 0 ) ; 
                         } 
                 } 
         } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' c l i c k ' ,   ' . h e l p ' ,   f u n c t i o n ( )   { 
             s h o w _ p o p u p ( ' h e l p ' ,   H E L P [ $ ( t h i s ) . a t t r ( ' i d ' ) ] ) ; 
         } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' c l i c k ' ,   ' . p o p u p - o p t i o n s - l i n k ' ,   f u n c t i o n ( )   { 
                 $ ( ' . p o p u p - o w n e r ' ) . r e m o v e C l a s s ( ' p o p u p - o w n e r ' ) ; 
                 $ ( t h i s ) . a d d C l a s s ( ' p o p u p - o w n e r ' ) ; 
                 v a r   t e m p l a t e   =   $ ( t h i s ) . a t t r ( ' t y p e ' )   +   ' - o p t i o n s ' ; 
                 s h o w _ p o p u p ( ' o p t i o n s ' ,   f o r m a t ( t e m p l a t e ,   { s p a n :   $ ( t h i s ) } ) ,   ' f a d e ' ) ; 
         } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' c l i c k ' ,   ' . r a t e - v i s i b i l i t y - o p t i o n ' ,   f u n c t i o n ( )   { 
                 v a r   k   =   $ ( t h i s ) . a t t r ( ' d a t a - p r e f ' ) ; 
                 v a r   s h o w   =   g e t _ p r e f ( k )   ! = =   ' t r u e ' ; 
                 s t o r e _ p r e f ( k ,   ' '   +   s h o w ) ; 
                 p a r t i a l _ u p d a t e ( ) ; 
         } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' f o c u s ' ,   ' i n p u t ,   s e l e c t ' ,   f u n c t i o n ( )   { 
                 u p d a t e _ c o u n t e r   =   0 ;   / /   I f   t h e r e ' s   i n t e r a c t i o n ,   r e s e t   t h e   c o u n t e r . 
         } ) ; 
 
         $ ( ' . t a g - l i n k ' ) . c l i c k ( f u n c t i o n ( )   { 
                 $ ( ' # t a g s ' ) . v a l ( $ ( t h i s ) . a t t r ( ' t a g ' ) ) ; 
         } ) ; 
 
         $ ( ' . a r g u m e n t - l i n k ' ) . c l i c k ( f u n c t i o n ( )   { 
                 v a r   f i e l d   =   $ ( t h i s ) . a t t r ( ' f i e l d ' ) ; 
                 v a r   r o w   =   $ ( ' # '   +   f i e l d ) . f i n d ( ' . m f ' ) . l a s t ( ) ; 
                 v a r   k e y   =   r o w . f i n d ( ' i n p u t ' ) . f i r s t ( ) ; 
                 v a r   v a l u e   =   r o w . f i n d ( ' i n p u t ' ) . l a s t ( ) ; 
                 v a r   t y p e   =   r o w . f i n d ( ' s e l e c t ' ) . l a s t ( ) ; 
                 k e y . v a l ( $ ( t h i s ) . a t t r ( ' k e y ' ) ) ; 
                 v a l u e . v a l ( $ ( t h i s ) . a t t r ( ' v a l u e ' ) ) ; 
                 t y p e . v a l ( $ ( t h i s ) . a t t r ( ' t y p e ' ) ) ; 
                 u p d a t e _ m u l t i f i e l d s ( ) ; 
         } ) ; 
 
         $ ( d o c u m e n t ) . o n ( ' c l i c k ' ,   ' f o r m . a u t o - s u b m i t   s e l e c t ,   f o r m . a u t o - s u b m i t   i n p u t ' ,   f u n c t i o n ( ) { 
                 $ ( t h i s ) . p a r e n t s ( ' f o r m ' ) . s u b m i t ( ) ; 
         } ) ; 
 
         $ ( ' # f i l t e r ' ) . o n ( ' k e y u p ' ,   d e b o u n c e ( u p d a t e _ f i l t e r ,   5 0 0 ) ) ; 
 
         $ ( ' # f i l t e r - r e g e x - m o d e ' ) . c h a n g e ( u p d a t e _ f i l t e r _ r e g e x _ m o d e ) ; 
 
         $ ( ' # t r u n c a t e ' ) . o n ( ' k e y u p ' ,   d e b o u n c e ( u p d a t e _ t r u n c a t e ,   5 0 0 ) ) ; 
 
         i f   ( !   u s e r _ a d m i n i s t r a t o r )   { 
                 $ ( ' . a d m i n i s t r a t o r - o n l y ' ) . r e m o v e ( ) ; 
         } 
 
         u p d a t e _ m u l t i f i e l d s ( ) ; 
 } 
 
 f u n c t i o n   u r l _ p a g i n a t i o n _ t e m p l a t e ( t e m p l a t e ,   d e f a u l t P a g e ,   d e f a u l t P a g e S i z e ) { 
         v a r   p a g e _ n u m b e r _ r e q u e s t   =   f m t _ p a g e _ n u m b e r _ r e q u e s t ( t e m p l a t e ,   d e f a u l t P a g e ) ; 
         v a r   p a g e _ s i z e   =   f m t _ p a g e _ s i z e _ r e q u e s t ( t e m p l a t e ,   d e f a u l t P a g e S i z e ) ; 
         v a r   n a m e _ r e q u e s t   =   f m t _ f i l t e r _ n a m e _ r e q u e s t ( t e m p l a t e ,   " " ) ; 
         v a r   u s e _ r e g e x   =   f m t _ r e g e x _ r e q u e s t ( t e m p l a t e ,   " " )   = =   " c h e c k e d " ; 
         i f   ( u s e _ r e g e x )   { 
                 n a m e _ r e q u e s t   =   e s c ( n a m e _ r e q u e s t ) ; 
         } 
         r e t u r n     ' / '   +   t e m p l a t e   + 
                 ' ? p a g e = '   +     p a g e _ n u m b e r _ r e q u e s t   + 
                 ' & p a g e _ s i z e = '   +   p a g e _ s i z e   + 
                 ' & n a m e = '   +   n a m e _ r e q u e s t   + 
                 ' & u s e _ r e g e x = '   +   u s e _ r e g e x ; 
 } 
 
 f u n c t i o n   s t o r e d _ p a g e _ i n f o ( t e m p l a t e ,   p a g e _ s t a r t ) { 
         v a r   p a g e S i z e   =   f m t _ s t r i p _ t a g s ( $ ( ' # '   +   t e m p l a t e + ' - p a g e s i z e ' ) . v a l ( ) ) ; 
         v a r   f i l t e r N a m e   =   f m t _ s t r i p _ t a g s ( $ ( ' # '   +   t e m p l a t e + ' - n a m e ' ) . v a l ( ) ) ; 
 
         s t o r e _ p r e f ( t e m p l a t e   +   ' _ c u r r e n t _ p a g e _ n u m b e r ' ,   p a g e _ s t a r t ) ; 
         i f   ( f i l t e r N a m e   ! =   n u l l   & &   f i l t e r N a m e   ! =   u n d e f i n e d )   { 
                 s t o r e _ p r e f ( t e m p l a t e   +   ' _ c u r r e n t _ f i l t e r _ n a m e ' ,   f i l t e r N a m e ) ; 
         } 
         v a r   r e g e x _ o n   =     $ ( " # "   +   t e m p l a t e   +   " - f i l t e r - r e g e x - m o d e " ) . i s ( ' : c h e c k e d ' ) ; 
 
         i f   ( r e g e x _ o n   ! =   n u l l   & &   r e g e x _ o n   ! =   u n d e f i n e d )   { 
                 s t o r e _ p r e f ( t e m p l a t e   +   ' _ c u r r e n t _ r e g e x ' ,   r e g e x _ o n   ?   " c h e c k e d "   :   "   "   ) ; 
         } 
 
         i f   ( p a g e S i z e   ! =   n u l l   & &   p a g e S i z e   ! =   u n d e f i n e d )   { 
                 s t o r e _ p r e f ( t e m p l a t e   +   ' _ c u r r e n t _ p a g e _ s i z e ' ,   p a g e S i z e ) ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ p a g e s ( t e m p l a t e ,   p a g e _ s t a r t ) { 
           s t o r e d _ p a g e _ i n f o ( t e m p l a t e ,   p a g e _ s t a r t ) ; 
           s w i t c h   ( t e m p l a t e )   { 
                   c a s e   ' q u e u e s '   :   r e n d e r Q u e u e s ( ) ;   b r e a k ; 
                   c a s e   ' e x c h a n g e s '   :   r e n d e r E x c h a n g e s ( ) ;   b r e a k ; 
                   c a s e   ' c o n n e c t i o n s '   :   r e n d e r C o n n e c t i o n s ( ) ;   b r e a k ; 
                   c a s e   ' c h a n n e l s '   :   r e n d e r C h a n n e l s ( ) ;   b r e a k ; 
           } 
 } 
 
 f u n c t i o n   r e n d e r Q u e u e s ( )   { 
         r e n d e r ( { ' q u e u e s ' :     { p a t h :   u r l _ p a g i n a t i o n _ t e m p l a t e ( ' q u e u e s ' ,   1 ,   1 0 0 ) , 
                                                 o p t i o n s :   { s o r t : t r u e ,   v h o s t : t r u e ,   p a g i n a t i o n : t r u e } } , 
                                                 ' v h o s t s ' :   ' / v h o s t s ' } ,   ' q u e u e s ' ,   ' # / q u e u e s ' ) ; 
 } 
 
 f u n c t i o n   r e n d e r E x c h a n g e s ( )   { 
         r e n d e r ( { ' e x c h a n g e s ' :     { p a t h :   u r l _ p a g i n a t i o n _ t e m p l a t e ( ' e x c h a n g e s ' ,   1 ,   1 0 0 ) , 
                                                     o p t i o n s :   { s o r t : t r u e ,   v h o s t : t r u e ,   p a g i n a t i o n : t r u e } } , 
                                                   ' v h o s t s ' :   ' / v h o s t s ' } ,   ' e x c h a n g e s ' ,   ' # / e x c h a n g e s ' ) ; 
 } 
 
 f u n c t i o n   r e n d e r C o n n e c t i o n s ( )   { 
         r e n d e r ( { ' c o n n e c t i o n s ' :   { p a t h :     u r l _ p a g i n a t i o n _ t e m p l a t e ( ' c o n n e c t i o n s ' ,   1 ,   1 0 0 ) , 
                                                         o p t i o n s :   { s o r t : t r u e } } } , 
                                                         ' c o n n e c t i o n s ' ,   ' # / c o n n e c t i o n s ' ) ; 
 } 
 
 f u n c t i o n   r e n d e r C h a n n e l s ( )   { 
         r e n d e r ( { ' c h a n n e l s ' :   { p a t h :     u r l _ p a g i n a t i o n _ t e m p l a t e ( ' c h a n n e l s ' ,   1 ,   1 0 0 ) , 
                                                 o p t i o n s :   { s o r t : t r u e } } } , 
                                                 ' c h a n n e l s ' ,   ' # / c h a n n e l s ' ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ p a g e s _ f r o m _ u i ( s e n d e r )   { 
         v a r   v a l   =   $ ( s e n d e r ) . v a l ( ) ; 
         v a r   r a w   =   ! ! $ ( s e n d e r ) . a t t r ( ' d a t a - p a g e - s t a r t ' )   ?   $ ( s e n d e r ) . a t t r ( ' d a t a - p a g e - s t a r t ' )   :   v a l ; 
         v a r   s       =   f m t _ s t r i p _ t a g s ( r a w ) ; 
         u p d a t e _ p a g e s ( c u r r e n t _ t e m p l a t e ,   s ) ; 
 } 
 
 f u n c t i o n   p o s t p r o c e s s _ p a r t i a l ( )   { 
         $ ( ' . p a g i n a t i o n _ c l a s s _ i n p u t ' ) . k e y p r e s s ( f u n c t i o n ( e )   { 
                 i f   ( e . k e y C o d e   = =   1 3 )   { 
                         u p d a t e _ p a g e s _ f r o m _ u i ( t h i s ) ; 
                 } 
         } ) ; 
 
         $ ( ' . p a g i n a t i o n _ c l a s s _ c h e c k b o x ' ) . c l i c k ( f u n c t i o n ( e )   { 
                 u p d a t e _ p a g e s _ f r o m _ u i ( t h i s ) ; 
         } ) ; 
 
         $ ( ' . p a g i n a t i o n _ c l a s s _ s e l e c t ' ) . c h a n g e ( f u n c t i o n ( e )   { 
                 u p d a t e _ p a g e s _ f r o m _ u i ( t h i s ) ; 
         } ) ; 
 
         s e t u p _ v i s i b i l i t y ( ) ; 
 
         $ ( ' # m a i n ' ) . o f f ( ' c l i c k ' ,   ' d i v . s e c t i o n   h 2 ,   d i v . s e c t i o n - h i d d e n   h 2 ' ) ; 
         $ ( ' # m a i n ' ) . o n ( ' c l i c k ' ,   ' d i v . s e c t i o n   h 2 ,   d i v . s e c t i o n - h i d d e n   h 2 ' ,   f u n c t i o n ( )   { 
                         t o g g l e _ v i s i b i l i t y ( $ ( t h i s ) ) ; 
                 } ) ; 
 
         $ ( ' . s o r t ' ) . c l i c k ( f u n c t i o n ( )   { 
                         v a r   s o r t   =   $ ( t h i s ) . a t t r ( ' s o r t ' ) ; 
                         i f   ( c u r r e n t _ s o r t   = =   s o r t )   { 
                                 c u r r e n t _ s o r t _ r e v e r s e   =   !   c u r r e n t _ s o r t _ r e v e r s e ; 
                         } 
                         e l s e   { 
                                 c u r r e n t _ s o r t   =   s o r t ; 
                                 c u r r e n t _ s o r t _ r e v e r s e   =   f a l s e ; 
                         } 
                         u p d a t e ( ) ; 
                 } ) ; 
 
         / /   T O D O   r e m o v e   t h i s   h a c k   w h e n   w e   g e t   r i d   o f   " u p d a t a b l e " 
         i f   ( $ ( ' # f i l t e r - w a r n i n g - s h o w ' ) . l e n g t h   >   0 )   { 
                 $ ( ' # f i l t e r - t r u n c a t e ' ) . a d d C l a s s ( ' f i l t e r - w a r n i n g ' ) ; 
         } 
         e l s e   { 
                 $ ( ' # f i l t e r - t r u n c a t e ' ) . r e m o v e C l a s s ( ' f i l t e r - w a r n i n g ' ) ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ m u l t i f i e l d s ( )   { 
         $ ( ' d i v . m u l t i f i e l d ' ) . e a c h ( f u n c t i o n ( i n d e x )   { 
                 u p d a t e _ m u l t i f i e l d ( $ ( t h i s ) ,   t r u e ) ; 
         } ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ m u l t i f i e l d ( m u l t i f i e l d ,   d i c t )   { 
         v a r   l a r g e s t _ i d   =   0 ; 
         v a r   e m p t y _ f o u n d   =   f a l s e ; 
         v a r   n a m e   =   m u l t i f i e l d . a t t r ( ' i d ' ) ; 
         v a r   t y p e _ i n p u t s   =   $ ( ' # '   +   n a m e   +   '   * [ n a m e $ = " _ m f t y p e " ] ' ) ; 
         t y p e _ i n p u t s . e a c h ( f u n c t i o n ( i n d e x )   { 
                 v a r   r e   =   n e w   R e g E x p ( n a m e   +   ' _ ( [ 0 - 9 ] * ) _ m f t y p e ' ) ; 
                 v a r   m a t c h   =   $ ( t h i s ) . a t t r ( ' n a m e ' ) . m a t c h ( r e ) ; 
                 i f   ( ! m a t c h )   r e t u r n ; 
                 v a r   i d   =   p a r s e I n t ( m a t c h [ 1 ] ) ; 
                 l a r g e s t _ i d   =   M a t h . m a x ( i d ,   l a r g e s t _ i d ) ; 
                 v a r   p r e f i x   =   n a m e   +   ' _ '   +   i d ; 
                 v a r   t y p e   =   $ ( t h i s ) . v a l ( ) ; 
                 v a r   i n p u t   =   $ ( ' # '   +   p r e f i x   +   ' _ m f v a l u e ' ) ; 
                 i f   ( t y p e   = =   ' l i s t ' )   { 
                         i f   ( i n p u t . s i z e ( )   = =   1 )   { 
                                 i n p u t . r e p l a c e W i t h ( ' < d i v   c l a s s = " m u l t i f i e l d - s u b "   i d = " '   +   p r e f i x   + 
                                                                     ' " > < / d i v > ' ) ; 
                         } 
                         u p d a t e _ m u l t i f i e l d ( $ ( ' # '   +   p r e f i x ) ,   f a l s e ) ; 
                 } 
                 e l s e   { 
                         i f   ( i n p u t . s i z e ( )   = =   1 )   { 
                                 v a r   k e y   =   d i c t   ?   $ ( ' # '   +   p r e f i x   +   ' _ m f k e y ' ) . v a l ( )   :   ' ' ; 
                                 v a r   v a l u e   =   i n p u t . v a l ( ) ; 
                                 i f   ( k e y   = =   ' '   & &   v a l u e   = =   ' ' )   { 
                                         i f   ( i n d e x   = =   t y p e _ i n p u t s . l e n g t h   -   1 )   { 
                                                 e m p t y _ f o u n d   =   t r u e ; 
                                         } 
                                         e l s e   { 
                                                 $ ( t h i s ) . p a r e n t s ( ' . m f ' ) . f i r s t ( ) . r e m o v e ( ) ; 
                                         } 
                                 } 
                         } 
                         e l s e   { 
                                 $ ( ' # '   +   p r e f i x ) . r e p l a c e W i t h ( m u l t i f i e l d _ i n p u t ( p r e f i x ,   ' v a l u e ' , 
                                                                                                                           ' t e x t ' ) ) ; 
                         } 
                 } 
         } ) ; 
         i f   ( ! e m p t y _ f o u n d )   { 
                 v a r   p r e f i x   =   n a m e   +   ' _ '   +   ( l a r g e s t _ i d   +   1 ) ; 
                 v a r   t   =   m u l t i f i e l d . h a s C l a s s ( ' s t r i n g - o n l y ' )   ?   ' h i d d e n '   :   ' s e l e c t ' ; 
                 v a r   v a l _ t y p e   =   m u l t i f i e l d _ i n p u t ( p r e f i x ,   ' v a l u e ' ,   ' t e x t ' )   +   '   '   + 
                         m u l t i f i e l d _ i n p u t ( p r e f i x ,   ' t y p e ' ,   t ) ; 
 
                 i f   ( d i c t )   { 
                         m u l t i f i e l d . a p p e n d ( ' < t a b l e   c l a s s = " m f " > < t r > < t d > '   + 
                                                             m u l t i f i e l d _ i n p u t ( p r e f i x ,   ' k e y ' ,   ' t e x t ' )   + 
                                                             ' < / t d > < t d   c l a s s = " e q u a l s " >   =   < / t d > < t d > '   + 
                                                             v a l _ t y p e   +   ' < / t d > < / t r > < / t a b l e > ' ) ; 
                 } 
                 e l s e   { 
                         m u l t i f i e l d . a p p e n d ( ' < d i v   c l a s s = " m f " > '   +   v a l _ t y p e   +   ' < / d i v > ' ) ; 
                 } 
         } 
 } 
 
 f u n c t i o n   m u l t i f i e l d _ i n p u t ( p r e f i x ,   s u f f i x ,   t y p e )   { 
         i f   ( t y p e   = =   ' h i d d e n '   )   { 
                 r e t u r n   ' < i n p u t   t y p e = " h i d d e n "   i d = " '   +   p r e f i x   +   ' _ m f '   +   s u f f i x   + 
                         ' "   n a m e = " '   +   p r e f i x   +   ' _ m f '   +   s u f f i x   +   ' "   v a l u e = " s t r i n g " / > ' ; 
         } 
         e l s e   i f   ( t y p e   = =   ' t e x t '   )   { 
                 r e t u r n   ' < i n p u t   t y p e = " t e x t "   i d = " '   +   p r e f i x   +   ' _ m f '   +   s u f f i x   + 
                         ' "   n a m e = " '   +   p r e f i x   +   ' _ m f '   +   s u f f i x   +   ' "   v a l u e = " " / > ' ; 
         } 
         e l s e   i f   ( t y p e   = =   ' s e l e c t '   )   { 
                 r e t u r n   ' < s e l e c t   i d = " '   +   p r e f i x   +   ' _ m f '   +   s u f f i x   +   ' "   n a m e = " '   +   p r e f i x   + 
                         ' _ m f '   +   s u f f i x   +   ' " > '   + 
                         ' < o p t i o n   v a l u e = " s t r i n g " > S t r i n g < / o p t i o n > '   + 
                         ' < o p t i o n   v a l u e = " n u m b e r " > N u m b e r < / o p t i o n > '   + 
                         ' < o p t i o n   v a l u e = " b o o l e a n " > B o o l e a n < / o p t i o n > '   + 
                         ' < o p t i o n   v a l u e = " l i s t " > L i s t < / o p t i o n > '   + 
                         ' < / s e l e c t > ' ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ f i l t e r _ r e g e x ( j E l e m )   { 
         c u r r e n t _ f i l t e r _ r e g e x   =   n u l l ; 
         j E l e m . p a r e n t s ( ' . f i l t e r ' ) . c h i l d r e n ( ' . s t a t u s - e r r o r ' ) . r e m o v e ( ) ; 
         i f   ( c u r r e n t _ f i l t e r _ r e g e x _ o n   & &   $ . t r i m ( c u r r e n t _ f i l t e r ) . l e n g t h   >   0 )   { 
                 t r y   { 
                         c u r r e n t _ f i l t e r _ r e g e x   =   n e w   R e g E x p ( c u r r e n t _ f i l t e r , ' i ' ) ; 
                 }   c a t c h   ( e )   { 
                         j E l e m . p a r e n t s ( ' . f i l t e r ' ) . a p p e n d ( ' < p   c l a s s = " s t a t u s - e r r o r " > '   + 
                                                                                         f m t _ e s c a p e _ h t m l ( e . m e s s a g e )   +   ' < / p > ' ) ; 
                 } 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ f i l t e r _ r e g e x _ m o d e ( )   { 
         c u r r e n t _ f i l t e r _ r e g e x _ o n   =   $ ( t h i s ) . i s ( ' : c h e c k e d ' ) ; 
         u p d a t e _ f i l t e r _ r e g e x ( $ ( t h i s ) ) ; 
         p a r t i a l _ u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ f i l t e r ( )   { 
         c u r r e n t _ f i l t e r   =   $ ( t h i s ) . v a l ( ) ; 
         v a r   t a b l e   =   $ ( t h i s ) . p a r e n t s ( ' t a b l e ' ) . f i r s t ( ) ; 
         t a b l e . r e m o v e C l a s s ( ' f i l t e r - a c t i v e ' ) ; 
         i f   ( $ ( t h i s ) . v a l ( )   ! =   ' ' )   { 
                 t a b l e . a d d C l a s s ( ' f i l t e r - a c t i v e ' ) ; 
         } 
         u p d a t e _ f i l t e r _ r e g e x ( $ ( t h i s ) ) ; 
         p a r t i a l _ u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ t r u n c a t e ( )   { 
         v a r   c u r r e n t _ t r u n c a t e _ s t r   = 
                 $ ( t h i s ) . v a l ( ) . r e p l a c e ( n e w   R e g E x p ( ' \ \ D ' ,   ' g ' ) ,   ' ' ) ; 
         i f   ( c u r r e n t _ t r u n c a t e _ s t r   = =   ' ' ) 
                 c u r r e n t _ t r u n c a t e _ s t r   =   ' 0 ' ; 
         i f   ( $ ( t h i s ) . v a l ( )   ! =   c u r r e n t _ t r u n c a t e _ s t r ) 
                 $ ( t h i s ) . v a l ( c u r r e n t _ t r u n c a t e _ s t r ) ; 
         c u r r e n t _ t r u n c a t e   =   p a r s e I n t ( c u r r e n t _ t r u n c a t e _ s t r ,   1 0 ) ; 
         s t o r e _ p r e f ( ' t r u n c a t e ' ,   c u r r e n t _ t r u n c a t e ) ; 
         p a r t i a l _ u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   s e t u p _ v i s i b i l i t y ( )   { 
         $ ( ' d i v . s e c t i o n , d i v . s e c t i o n - h i d d e n ' ) . e a c h ( f u n c t i o n ( _ i n d e x )   { 
                 v a r   p r e f   =   s e c t i o n _ p r e f ( c u r r e n t _ t e m p l a t e , 
                                                                 $ ( t h i s ) . c h i l d r e n ( ' h 2 ' ) . t e x t ( ) ) ; 
                 v a r   s h o w   =   g e t _ p r e f ( p r e f ) ; 
                 i f   ( s h o w   = =   n u l l )   { 
                         s h o w   =   $ ( t h i s ) . h a s C l a s s ( ' s e c t i o n ' ) ; 
                 } 
                 e l s e   { 
                         s h o w   =   s h o w   = =   ' t ' ; 
                 } 
                 i f   ( s h o w )   { 
                         $ ( t h i s ) . a d d C l a s s ( ' s e c t i o n - v i s i b l e ' ) ; 
                         / /   W o r k a r o u n d   f o r . . .   s o m e t h i n g .   A l t h o u g h   d i v . h i d e r   i s 
                         / /   d i s p l a y : b l o c k   a n y w a y ,   n o t   e x p l i c i t l y   s e t t i n g   t h i s 
                         / /   p r e v e n t s   t h e   f i r s t   s l i d e T o g g l e ( )   f r o m   a n i m a t i n g 
                         / /   s u c c e s s f u l l y ;   i n s t e a d   t h e   e l e m e n t   j u s t   v a n i s h e s . 
                         $ ( t h i s ) . f i n d ( ' . h i d e r ' ) . a t t r ( ' s t y l e ' ,   ' d i s p l a y : b l o c k ; ' ) ; 
                 } 
                 e l s e   { 
                         $ ( t h i s ) . a d d C l a s s ( ' s e c t i o n - i n v i s i b l e ' ) ; 
                 } 
         } ) ; 
 } 
 
 f u n c t i o n   t o g g l e _ v i s i b i l i t y ( i t e m )   { 
         v a r   h i d e r   =   i t e m . n e x t ( ) ; 
         v a r   a l l   =   i t e m . p a r e n t ( ) ; 
         v a r   p r e f   =   s e c t i o n _ p r e f ( c u r r e n t _ t e m p l a t e ,   i t e m . t e x t ( ) ) ; 
         i t e m . n e x t ( ) . s l i d e T o g g l e ( 1 0 0 ) ; 
         i f   ( a l l . h a s C l a s s ( ' s e c t i o n - v i s i b l e ' ) )   { 
                 i f   ( a l l . h a s C l a s s ( ' s e c t i o n ' ) ) 
                         s t o r e _ p r e f ( p r e f ,   ' f ' ) ; 
                 e l s e 
                         c l e a r _ p r e f ( p r e f ) ; 
                 a l l . r e m o v e C l a s s ( ' s e c t i o n - v i s i b l e ' ) ; 
                 a l l . a d d C l a s s ( ' s e c t i o n - i n v i s i b l e ' ) ; 
         } 
         e l s e   { 
                 i f   ( a l l . h a s C l a s s ( ' s e c t i o n - h i d d e n ' ) )   { 
                         s t o r e _ p r e f ( p r e f ,   ' t ' ) ; 
                 }   e l s e   { 
                         c l e a r _ p r e f ( p r e f ) ; 
                 } 
                 a l l . r e m o v e C l a s s ( ' s e c t i o n - i n v i s i b l e ' ) ; 
                 a l l . a d d C l a s s ( ' s e c t i o n - v i s i b l e ' ) ; 
         } 
 } 
 
 f u n c t i o n   p u b l i s h _ m s g ( p a r a m s 0 )   { 
         t r y   { 
                 v a r   p a r a m s   =   p a r a m s _ m a g i c ( p a r a m s 0 ) ; 
                 p u b l i s h _ m s g 0 ( p a r a m s ) ; 
         }   c a t c h   ( e )   { 
                 s h o w _ p o p u p ( ' w a r n ' ,   f m t _ e s c a p e _ h t m l ( e ) ) ; 
                 r e t u r n   f a l s e ; 
         } 
 } 
 
 f u n c t i o n   p u b l i s h _ m s g 0 ( p a r a m s )   { 
         v a r   p a t h   =   f i l l _ p a t h _ t e m p l a t e ( ' / e x c h a n g e s / : v h o s t / : n a m e / p u b l i s h ' ,   p a r a m s ) ; 
         p a r a m s [ ' p a y l o a d _ e n c o d i n g ' ]   =   ' s t r i n g ' ; 
         p a r a m s [ ' p r o p e r t i e s ' ]   =   { } ; 
         p a r a m s [ ' p r o p e r t i e s ' ] [ ' d e l i v e r y _ m o d e ' ]   =   p a r s e I n t ( p a r a m s [ ' d e l i v e r y _ m o d e ' ] ) ; 
         i f   ( p a r a m s [ ' h e a d e r s ' ]   ! =   ' ' ) 
                 p a r a m s [ ' p r o p e r t i e s ' ] [ ' h e a d e r s ' ]   =   p a r a m s [ ' h e a d e r s ' ] ; 
         v a r   p r o p s   =   [ [ ' c o n t e n t _ t y p e ' ,           ' s t r ' ] , 
                                   [ ' c o n t e n t _ e n c o d i n g ' ,   ' s t r ' ] , 
                                   [ ' c o r r e l a t i o n _ i d ' ,       ' s t r ' ] , 
                                   [ ' r e p l y _ t o ' ,                   ' s t r ' ] , 
                                   [ ' e x p i r a t i o n ' ,               ' s t r ' ] , 
                                   [ ' m e s s a g e _ i d ' ,               ' s t r ' ] , 
                                   [ ' t y p e ' ,                           ' s t r ' ] , 
                                   [ ' u s e r _ i d ' ,                     ' s t r ' ] , 
                                   [ ' a p p _ i d ' ,                       ' s t r ' ] , 
                                   [ ' c l u s t e r _ i d ' ,               ' s t r ' ] , 
                                   [ ' p r i o r i t y ' ,                   ' i n t ' ] , 
                                   [ ' t i m e s t a m p ' ,                 ' i n t ' ] ] ; 
         f o r   ( v a r   i   i n   p r o p s )   { 
                 v a r   n a m e   =   p r o p s [ i ] [ 0 ] ; 
                 v a r   t y p e   =   p r o p s [ i ] [ 1 ] ; 
                 i f   ( p a r a m s [ ' p r o p s ' ] [ n a m e ]   ! =   u n d e f i n e d   & &   p a r a m s [ ' p r o p s ' ] [ n a m e ]   ! =   ' ' )   { 
                         v a r   v a l u e   =   p a r a m s [ ' p r o p s ' ] [ n a m e ] ; 
                         i f   ( t y p e   = =   ' i n t ' )   v a l u e   =   p a r s e I n t ( v a l u e ) ; 
                         p a r a m s [ ' p r o p e r t i e s ' ] [ n a m e ]   =   v a l u e ; 
                 } 
         } 
         w i t h _ r e q ( ' P O S T ' ,   p a t h ,   J S O N . s t r i n g i f y ( p a r a m s ) ,   f u n c t i o n ( r e s p )   { 
                         v a r   r e s u l t   =   j Q u e r y . p a r s e J S O N ( r e s p . r e s p o n s e T e x t ) ; 
                         i f   ( r e s u l t . r o u t e d )   { 
                                 s h o w _ p o p u p ( ' i n f o ' ,   ' M e s s a g e   p u b l i s h e d . ' ) ; 
                         }   e l s e   { 
                                 s h o w _ p o p u p ( ' w a r n ' ,   ' M e s s a g e   p u b l i s h e d ,   b u t   n o t   r o u t e d . ' ) ; 
                         } 
                 } ) ; 
 } 
 
 f u n c t i o n   g e t _ m s g s ( p a r a m s )   { 
         v a r   p a t h   =   f i l l _ p a t h _ t e m p l a t e ( ' / q u e u e s / : v h o s t / : n a m e / g e t ' ,   p a r a m s ) ; 
         w i t h _ r e q ( ' P O S T ' ,   p a t h ,   J S O N . s t r i n g i f y ( p a r a m s ) ,   f u n c t i o n ( r e s p )   { 
                         v a r   m s g s   =   j Q u e r y . p a r s e J S O N ( r e s p . r e s p o n s e T e x t ) ; 
                         i f   ( m s g s . l e n g t h   = =   0 )   { 
                                 s h o w _ p o p u p ( ' i n f o ' ,   ' Q u e u e   i s   e m p t y ' ) ; 
                         }   e l s e   { 
                                 $ ( ' # m s g - w r a p p e r ' ) . s l i d e U p ( 2 0 0 ) ; 
                                 r e p l a c e _ c o n t e n t ( ' m s g - w r a p p e r ' ,   f o r m a t ( ' m e s s a g e s ' ,   { ' m s g s ' :   m s g s } ) ) ; 
                                 $ ( ' # m s g - w r a p p e r ' ) . s l i d e D o w n ( 2 0 0 ) ; 
                         } 
                 } ) ; 
 } 
 
 f u n c t i o n   w i t h _ r e q s ( r e q s ,   a c c ,   f u n )   { 
         i f   ( k e y s ( r e q s ) . l e n g t h   >   0 )   { 
                 v a r   k e y   =   k e y s ( r e q s ) [ 0 ] ; 
                 w i t h _ r e q ( ' G E T ' ,   r e q s [ k e y ] ,   n u l l ,   f u n c t i o n ( r e s p )   { 
                                 a c c [ k e y ]   =   j Q u e r y . p a r s e J S O N ( r e s p . r e s p o n s e T e x t ) ; 
                                 v a r   r e m a i n d e r   =   { } ; 
                                 f o r   ( v a r   k   i n   r e q s )   { 
                                         i f   ( k   ! =   k e y )   r e m a i n d e r [ k ]   =   r e q s [ k ] ; 
                                 } 
                                 w i t h _ r e q s ( r e m a i n d e r ,   a c c ,   f u n ) ; 
                         } ) ; 
         } 
         e l s e   { 
                 f u n ( a c c ) ; 
         } 
 } 
 
 f u n c t i o n   r e p l a c e _ c o n t e n t ( i d ,   h t m l )   { 
         $ ( " # "   +   i d ) . h t m l ( h t m l ) ; 
 } 
 
 v a r   e j s _ c a c h e d   =   { } ; 
 
 f u n c t i o n   f o r m a t ( t e m p l a t e ,   j s o n )   { 
         t r y   { 
                 v a r   c a c h e   =   t r u e ; 
                 i f   ( ! ( t e m p l a t e   i n   e j s _ c a c h e d ) )   { 
                         e j s _ c a c h e d [ t e m p l a t e ]   =   t r u e ; 
                         c a c h e   =   f a l s e ; 
                 } 
                 v a r   t m p l   =   n e w   E J S ( { u r l :   ' j s / t m p l / '   +   t e m p l a t e   +   ' . e j s ' ,   c a c h e :   c a c h e } ) ; 
                 r e t u r n   t m p l . r e n d e r ( j s o n ) ; 
         }   c a t c h   ( e r r )   { 
                 c l e a r I n t e r v a l ( t i m e r ) ; 
                 c o n s o l e . l o g ( " U n c a u g h t   e r r o r :   "   +   e r r ) ; 
                 c o n s o l e . l o g ( " S t a c k :   "   +   e r r [ ' s t a c k ' ] ) ; 
                 d e b u g ( e r r [ ' n a m e ' ]   +   " :   "   +   e r r [ ' m e s s a g e ' ]   +   " \ n "   +   e r r [ ' s t a c k ' ]   +   " \ n " ) ; 
         } 
 } 
 
 f u n c t i o n   u p d a t e _ s t a t u s ( s t a t u s )   { 
         v a r   t e x t ; 
         i f   ( s t a t u s   = =   ' o k ' ) 
                 t e x t   =   " R e f r e s h e d   "   +   f m t _ d a t e ( n e w   D a t e ( ) ) ; 
         e l s e   i f   ( s t a t u s   = =   ' e r r o r ' )   { 
                 v a r   n e x t _ t r y   =   n e w   D a t e ( n e w   D a t e ( ) . g e t T i m e ( )   +   t i m e r _ i n t e r v a l ) ; 
                 t e x t   =   " E r r o r :   c o u l d   n o t   c o n n e c t   t o   s e r v e r   s i n c e   "   + 
                         f m t _ d a t e ( l a s t _ s u c c e s s f u l _ c o n n e c t )   +   " .   W i l l   r e t r y   a t   "   + 
                         f m t _ d a t e ( n e x t _ t r y )   +   " . " ; 
         } 
         e l s e 
                 t h r o w ( " U n k n o w n   s t a t u s   "   +   s t a t u s ) ; 
 
         v a r   h t m l   =   f o r m a t ( ' s t a t u s ' ,   { s t a t u s :   s t a t u s ,   t e x t :   t e x t } ) ; 
         r e p l a c e _ c o n t e n t ( ' s t a t u s ' ,   h t m l ) ; 
 } 
 
 f u n c t i o n   h a s _ a u t h _ c o o k i e _ v a l u e ( )   { 
         r e t u r n   g e t _ c o o k i e _ v a l u e ( ' a u t h ' )   ! =   n u l l ; 
 } 
 
 f u n c t i o n   a u t h _ h e a d e r ( )   { 
         i f ( h a s _ a u t h _ c o o k i e _ v a l u e ( ) )   { 
                 r e t u r n   " B a s i c   "   +   d e c o d e U R I C o m p o n e n t ( g e t _ c o o k i e _ v a l u e ( ' a u t h ' ) ) ;         
         }   e l s e   { 
                 r e t u r n   n u l l ; 
         } 
 } 
 
 f u n c t i o n   w i t h _ r e q ( m e t h o d ,   p a t h ,   b o d y ,   f u n )   { 
         i f ( ! h a s _ a u t h _ c o o k i e _ v a l u e ( ) )   { 
                 / /   n a v i g a t e   t o   t h e   l o g i n   f o r m 
                 l o c a t i o n . r e l o a d ( ) ; 
                 r e t u r n ; 
         } 
 
         v a r   j s o n ; 
         v a r   r e q   =   x m l H t t p R e q u e s t ( ) ; 
         r e q . o p e n ( m e t h o d ,   ' a p i '   +   p a t h ,   t r u e   ) ; 
         r e q . s e t R e q u e s t H e a d e r ( ' a u t h o r i z a t i o n ' ,   a u t h _ h e a d e r ( ) ) ; 
         r e q . s e t R e q u e s t H e a d e r ( ' x - v h o s t ' ,   c u r r e n t _ v h o s t ) ; 
         r e q . o n r e a d y s t a t e c h a n g e   =   f u n c t i o n   ( )   { 
                 i f   ( r e q . r e a d y S t a t e   = =   4 )   { 
                         v a r   i x   =   j Q u e r y . i n A r r a y ( r e q ,   o u t s t a n d i n g _ r e q s ) ; 
                         i f   ( i x   ! =   - 1 )   { 
                                 o u t s t a n d i n g _ r e q s . s p l i c e ( i x ,   1 ) ; 
                         } 
                         i f   ( c h e c k _ b a d _ r e s p o n s e ( r e q ,   t r u e ) )   { 
                                 l a s t _ s u c c e s s f u l _ c o n n e c t   =   n e w   D a t e ( ) ; 
                                 f u n ( r e q ) ; 
                         } 
                 } 
         } ; 
         o u t s t a n d i n g _ r e q s . p u s h ( r e q ) ; 
         r e q . s e n d ( b o d y ) ; 
 } 
 
 f u n c t i o n   s y n c _ g e t ( p a t h )   { 
         r e t u r n   s y n c _ r e q ( ' G E T ' ,   [ ] ,   p a t h ) ; 
 } 
 
 f u n c t i o n   s y n c _ p u t ( s a m m y ,   p a t h _ t e m p l a t e )   { 
         r e t u r n   s y n c _ r e q ( ' P U T ' ,   s a m m y . p a r a m s ,   p a t h _ t e m p l a t e ) ; 
 } 
 
 f u n c t i o n   s y n c _ d e l e t e ( s a m m y ,   p a t h _ t e m p l a t e ,   o p t i o n s )   { 
         r e t u r n   s y n c _ r e q ( ' D E L E T E ' ,   s a m m y . p a r a m s ,   p a t h _ t e m p l a t e ,   o p t i o n s ) ; 
 } 
 
 f u n c t i o n   s y n c _ p o s t ( s a m m y ,   p a t h _ t e m p l a t e )   { 
         r e t u r n   s y n c _ r e q ( ' P O S T ' ,   s a m m y . p a r a m s ,   p a t h _ t e m p l a t e ) ; 
 } 
 
 f u n c t i o n   s y n c _ r e q ( t y p e ,   p a r a m s 0 ,   p a t h _ t e m p l a t e ,   o p t i o n s )   { 
         v a r   p a r a m s ; 
         v a r   p a t h ; 
         t r y   { 
                 p a r a m s   =   p a r a m s _ m a g i c ( p a r a m s 0 ) ; 
                 p a t h   =   f i l l _ p a t h _ t e m p l a t e ( p a t h _ t e m p l a t e ,   p a r a m s ) ; 
         }   c a t c h   ( e )   { 
                 s h o w _ p o p u p ( ' w a r n ' ,   f m t _ e s c a p e _ h t m l ( e ) ) ; 
                 r e t u r n   f a l s e ; 
         } 
         v a r   r e q   =   x m l H t t p R e q u e s t ( ) ; 
         r e q . o p e n ( t y p e ,   ' a p i '   +   p a t h ,   f a l s e ) ; 
         r e q . s e t R e q u e s t H e a d e r ( ' c o n t e n t - t y p e ' ,   ' a p p l i c a t i o n / j s o n ' ) ; 
         r e q . s e t R e q u e s t H e a d e r ( ' a u t h o r i z a t i o n ' ,   a u t h _ h e a d e r ( ) ) ; 
 
         i f   ( o p t i o n s   ! =   u n d e f i n e d   | |   o p t i o n s   ! =   n u l l )   { 
                 i f   ( o p t i o n s . h e a d e r s   ! =   u n d e f i n e d   | |   o p t i o n s . h e a d e r s   ! =   n u l l )   { 
                         j Q u e r y . e a c h ( o p t i o n s . h e a d e r s ,   f u n c t i o n   ( k ,   v )   { 
                         r e q . s e t R e q u e s t H e a d e r ( k ,   v ) ; 
                         } ) ; 
                 } 
         } 
 
         t r y   { 
                 i f   ( t y p e   = =   ' G E T ' ) 
                         r e q . s e n d ( n u l l ) ; 
                 e l s e 
                         r e q . s e n d ( J S O N . s t r i n g i f y ( p a r a m s ) ) ; 
         } 
         c a t c h   ( e )   { 
                 i f   ( e . n u m b e r   = =   0 x 8 0 0 0 4 0 0 4 )   { 
                         / /   0 x 8 0 0 0 4 0 0 4   m e a n s   " O p e r a t i o n   a b o r t e d . " 
                         / /   h t t p : / / s u p p o r t . m i c r o s o f t . c o m / k b / 1 8 6 0 6 3 
                         / /   M S I E 6   a p p e a r s   t o   d o   t h i s   i n   r e s p o n s e   t o   H T T P   2 0 4 . 
                 } 
         } 
 
         i f   ( c h e c k _ b a d _ r e s p o n s e ( r e q ,   f a l s e ) )   { 
                 i f   ( t y p e   = =   ' G E T ' ) 
                         r e t u r n   r e q . r e s p o n s e T e x t ; 
                 e l s e 
                         r e t u r n   t r u e ; 
         } 
         e l s e   { 
                 r e t u r n   f a l s e ; 
         } 
 } 
 
 f u n c t i o n   c h e c k _ b a d _ r e s p o n s e ( r e q ,   f u l l _ p a g e _ 4 0 4 )   { 
         / /   1 2 2 3   = =   2 0 4   -   s e e   h t t p : / / w w w . e n h a n c e i e . c o m / i e / b u g s . a s p 
         / /   M S I E 7   a n d   8   a p p e a r   t o   d o   t h i s   i n   r e s p o n s e   t o   H T T P   2 0 4 . 
         i f   ( ( r e q . s t a t u s   > =   2 0 0   & &   r e q . s t a t u s   <   3 0 0 )   | |   r e q . s t a t u s   = =   1 2 2 3 )   { 
                 r e t u r n   t r u e ; 
         } 
         e l s e   i f   ( r e q . s t a t u s   = =   4 0 4   & &   f u l l _ p a g e _ 4 0 4 )   { 
                 v a r   h t m l   =   f o r m a t ( ' 4 0 4 ' ,   { } ) ; 
                 r e p l a c e _ c o n t e n t ( ' m a i n ' ,   h t m l ) ; 
         } 
         e l s e   i f   ( r e q . s t a t u s   > =   4 0 0   & &   r e q . s t a t u s   < =   4 0 4 )   { 
                 v a r   r e a s o n   =   J S O N . p a r s e ( r e q . r e s p o n s e T e x t ) . r e a s o n ; 
                 i f   ( t y p e o f ( r e a s o n )   ! =   ' s t r i n g ' )   r e a s o n   =   J S O N . s t r i n g i f y ( r e a s o n ) ; 
 
                 v a r   e r r o r   =   J S O N . p a r s e ( r e q . r e s p o n s e T e x t ) . e r r o r ; 
                 i f   ( t y p e o f ( e r r o r )   ! =   ' s t r i n g ' )   e r r o r   =   J S O N . s t r i n g i f y ( e r r o r ) ; 
 
                 i f   ( e r r o r   = =   ' b a d _ r e q u e s t '   | |   e r r o r   = =   ' n o t _ f o u n d '   | |   e r r o r   = =   ' n o t _ a u t h o r i s e d ' )   { 
                         s h o w _ p o p u p ( ' w a r n ' ,   f m t _ e s c a p e _ h t m l ( r e a s o n ) ) ; 
                 }   e l s e   i f   ( e r r o r   = =   ' p a g e _ o u t _ o f _ r a n g e ' )   { 
                         v a r   s e c o n d s   =   6 0 ; 
                         i f   ( l a s t _ p a g e _ o u t _ o f _ r a n g e _ e r r o r   >   0 ) 
                                         s e c o n d s   =   ( n e w   D a t e ( ) . g e t T i m e ( )   -   l a s t _ p a g e _ o u t _ o f _ r a n g e _ e r r o r . g e t T i m e ( ) ) / 1 0 0 0 ; 
                         i f   ( s e c o n d s   >   3 )   { 
                                   S a m m y . l o g ( ' s e r v e r   r e p o r t s   p a g e   i s   o u t   o f   r a n g e ,   r e d i r e c t i n g   t o   p a g e   1 ' ) ; 
                                   v a r   c o n t e x t s   =   [ " q u e u e s " ,   " e x c h a n g e s " ,   " c o n n e c t i o n s " ,   " c h a n n e l s " ] ; 
                                   v a r   m a t c h e s   =   / a p i \ / ( . * ) \ ? / . e x e c ( r e q . r e s p o n s e U R L ) ; 
                                   i f   ( m a t c h e s   ! =   n u l l   & &   m a t c h e s . l e n g t h   >   1 )   { 
                                           c o n t e x t s . f o r E a c h ( f u n c t i o n ( i t e m )   { 
                                                   i f   ( m a t c h e s [ 1 ] . i n d e x O f ( i t e m )   = =   0 )   { u p d a t e _ p a g e s ( i t e m ,   1 ) } ; 
                                           } ) ; 
                                   }   e l s e   u p d a t e _ p a g e s ( c u r r e n t _ t e m p l a t e ,   1 ) ; 
 
                                   l a s t _ p a g e _ o u t _ o f _ r a n g e _ e r r o r   =   n e w   D a t e ( ) ; 
                         } 
                 } 
         } 
         e l s e   i f   ( r e q . s t a t u s   = =   4 0 8 )   { 
                 u p d a t e _ s t a t u s ( ' t i m e o u t ' ) ; 
         } 
         e l s e   i f   ( r e q . s t a t u s   = =   0 )   {   / /   N o n - M S I E :   c o u l d   n o t   c o n n e c t 
                 u p d a t e _ s t a t u s ( ' e r r o r ' ) ; 
         } 
         e l s e   i f   ( r e q . s t a t u s   >   1 2 0 0 0 )   {   / /   M S I E :   c o u l d   n o t   c o n n e c t 
                 u p d a t e _ s t a t u s ( ' e r r o r ' ) ; 
         } 
         e l s e   i f   ( r e q . s t a t u s   = =   5 0 3 )   {   / /   P r o x y :   c o u l d   n o t   c o n n e c t 
                 u p d a t e _ s t a t u s ( ' e r r o r ' ) ; 
         } 
         e l s e   { 
                 d e b u g ( " M a n a g e m e n t   A P I   r e t u r n e d   s t a t u s   c o d e   "   +   r e q . s t a t u s   +   "   -   < s t r o n g > "   +   f m t _ e s c a p e _ h t m l _ o n e _ l i n e ( r e q . r e s p o n s e T e x t )   +   " < / s t r o n g > " ) ; 
                 c l e a r I n t e r v a l ( t i m e r ) ; 
         } 
 
         r e t u r n   f a l s e ; 
 } 
 
 f u n c t i o n   f i l l _ p a t h _ t e m p l a t e ( t e m p l a t e ,   p a r a m s )   { 
         v a r   r e   =   / : [ a - z A - Z _ ] * / g ; 
         r e t u r n   t e m p l a t e . r e p l a c e ( r e ,   f u n c t i o n ( m )   { 
                         v a r   s t r   =   e s c ( p a r a m s [ m . s u b s t r i n g ( 1 ) ] ) ; 
                         i f   ( s t r   = =   ' ' )   { 
                                 t h r o w ( m . s u b s t r i n g ( 1 )   +   "   i s   r e q u i r e d " ) ; 
                         } 
                         r e t u r n   s t r ; 
                 } ) ; 
 } 
 
 f u n c t i o n   p a r a m s _ m a g i c ( p a r a m s )   { 
         r e t u r n   c h e c k _ p a s s w o r d ( m a y b e _ r e m o v e _ f i e l d s ( c o l l a p s e _ m u l t i f i e l d s ( p a r a m s ) ) ) ; 
 } 
 
 f u n c t i o n   c o l l a p s e _ m u l t i f i e l d s ( p a r a m s 0 )   { 
         f u n c t i o n   s e t ( x )   {   r e t u r n   x   ! =   ' '   & &   x   ! =   u n d e f i n e d   } 
 
         v a r   p a r a m s   =   { } ; 
         v a r   k s   =   k e y s ( p a r a m s 0 ) ; 
         v a r   i d s   =   [ ] ; 
         f o r   ( i   i n   k s )   { 
                 v a r   k e y   =   k s [ i ] ; 
                 v a r   m a t c h   =   k e y . m a t c h ( / ( [ a - z ] * ) _ ( [ 0 - 9 _ ] * ) _ m f t y p e / ) ; 
                 v a r   m a t c h 2   =   k e y . m a t c h ( / [ a - z ] * _ [ 0 - 9 _ ] * _ m f k e y / ) ; 
                 v a r   m a t c h 3   =   k e y . m a t c h ( / [ a - z ] * _ [ 0 - 9 _ ] * _ m f v a l u e / ) ; 
                 i f   ( m a t c h   = =   n u l l   & &   m a t c h 2   = =   n u l l   & &   m a t c h 3   = =   n u l l )   { 
                         p a r a m s [ k e y ]   =   p a r a m s 0 [ k e y ] ; 
                 } 
                 e l s e   i f   ( m a t c h   = =   n u l l )   { 
                         / /   D o   n o t h i n g ,   v a l u e   i s   h a n d l e d   b e l o w 
                 } 
                 e l s e   { 
                         v a r   n a m e   =   m a t c h [ 1 ] ; 
                         v a r   i d   =   m a t c h [ 2 ] ; 
                         i d s . p u s h ( [ n a m e ,   i d ] ) ; 
                 } 
         } 
         i d s . s o r t ( ) ; 
         v a r   i d _ m a p   =   { } ; 
         f o r   ( i   i n   i d s )   { 
                 v a r   n a m e   =   i d s [ i ] [ 0 ] ; 
                 v a r   i d   =   i d s [ i ] [ 1 ] ; 
                 i f   ( p a r a m s [ n a m e ]   = =   u n d e f i n e d )   { 
                         p a r a m s [ n a m e ]   =   { } ; 
                         i d _ m a p [ n a m e ]   =   { } ; 
                 } 
                 v a r   i d _ p a r t s   =   i d . s p l i t ( ' _ ' ) ; 
                 v a r   k   =   p a r a m s 0 [ n a m e   +   ' _ '   +   i d _ p a r t s [ 0 ]   +   ' _ m f k e y ' ] ; 
                 v a r   v   =   p a r a m s 0 [ n a m e   +   ' _ '   +   i d   +   ' _ m f v a l u e ' ] ; 
                 v a r   t   =   p a r a m s 0 [ n a m e   +   ' _ '   +   i d   +   ' _ m f t y p e ' ] ; 
                 v a r   v a l   =   n u l l ; 
                 v a r   t o p _ l e v e l   =   i d _ p a r t s . l e n g t h   = =   1 ; 
                 i f   ( t   = =   ' l i s t ' )   { 
                         v a l   =   [ ] ; 
                         i d _ m a p [ n a m e ] [ i d ]   =   v a l ; 
                 } 
                 e l s e   i f   ( ( s e t ( k )   & &   t o p _ l e v e l )   | |   s e t ( v ) )   { 
                         i f   ( t   = =   ' b o o l e a n ' )   { 
                                 i f   ( v   ! =   ' t r u e '   & &   v   ! =   ' f a l s e ' ) 
                                         t h r o w ( k   +   '   m u s t   b e   " t r u e "   o r   " f a l s e " ;   g o t   '   +   v ) ; 
                                 v a l   =   ( v   = =   ' t r u e ' ) ; 
                         } 
                         e l s e   i f   ( t   = =   ' n u m b e r ' )   { 
                                 v a r   n   =   p a r s e F l o a t ( v ) ; 
                                 i f   ( i s N a N ( n ) ) 
                                         t h r o w ( k   +   '   m u s t   b e   a   n u m b e r ;   g o t   '   +   v ) ; 
                                 v a l   =   n ; 
                         } 
                         e l s e   { 
                                 v a l   =   v ; 
                         } 
                 } 
                 i f   ( v a l   ! =   n u l l )   { 
                         i f   ( t o p _ l e v e l )   { 
                                 p a r a m s [ n a m e ] [ k ]   =   v a l ; 
                         } 
                         e l s e   { 
                                 v a r   p r e f i x   =   i d _ p a r t s . s l i c e ( 0 ,   i d _ p a r t s . l e n g t h   -   1 ) . j o i n ( ' _ ' ) ; 
                                 i d _ m a p [ n a m e ] [ p r e f i x ] . p u s h ( v a l ) ; 
                         } 
                 } 
         } 
         r e t u r n   p a r a m s ; 
 } 
 
 f u n c t i o n   c h e c k _ p a s s w o r d ( p a r a m s )   { 
         i f   ( p a r a m s [ ' p a s s w o r d ' ]   ! =   u n d e f i n e d )   { 
                 i f   ( p a r a m s [ ' p a s s w o r d ' ]   = =   ' ' )   { 
                         t h r o w ( " P l e a s e   s p e c i f y   a   p a s s w o r d . " ) ; 
                 } 
                 i f   ( p a r a m s [ ' p a s s w o r d ' ]   ! =   p a r a m s [ ' p a s s w o r d _ c o n f i r m ' ] )   { 
                         t h r o w ( " P a s s w o r d s   d o   n o t   m a t c h . " ) ; 
                 } 
                 d e l e t e   p a r a m s [ ' p a s s w o r d _ c o n f i r m ' ] ; 
         } 
 
         r e t u r n   p a r a m s ; 
 } 
 
 f u n c t i o n   m a y b e _ r e m o v e _ f i e l d s ( p a r a m s )   { 
         $ ( ' . c o n t r o l s - a p p e a r a n c e ' ) . e a c h ( f u n c t i o n ( i n d e x )   { 
                 v a r   o p t i o n s   =   $ ( t h i s ) . g e t ( 0 ) . o p t i o n s ; 
                 v a r   s e l e c t e d   =   $ ( t h i s ) . v a l ( ) ; 
 
                 f o r   ( i   =   0 ;   i   <   o p t i o n s . l e n g t h ;   i + + )   { 
                         v a r   o p t i o n   =   o p t i o n s [ i ] . v a l u e ; 
                         i f   ( o p t i o n   ! =   s e l e c t e d )   { 
                                 d e l e t e   p a r a m s [ o p t i o n ] ; 
                         } 
                 } 
                 d e l e t e   p a r a m s [ $ ( t h i s ) . a t t r ( ' n a m e ' ) ] ; 
         } ) ; 
         r e t u r n   p a r a m s ; 
 } 
 
 f u n c t i o n   p u t _ p a r a m e t e r ( s a m m y ,   m a n d a t o r y _ k e y s ,   n u m _ k e y s ,   b o o l _ k e y s , 
                                               a r r a y a b l e _ k e y s )   { 
         f o r   ( v a r   i   i n   s a m m y . p a r a m s )   { 
                 i f   ( i   = = =   ' l e n g t h '   | |   ! s a m m y . p a r a m s . h a s O w n P r o p e r t y ( i ) )   c o n t i n u e ; 
                 i f   ( s a m m y . p a r a m s [ i ]   = =   ' '   & &   j Q u e r y . i n A r r a y ( i ,   m a n d a t o r y _ k e y s )   = =   - 1 )   { 
                         d e l e t e   s a m m y . p a r a m s [ i ] ; 
                 } 
                 e l s e   i f   ( j Q u e r y . i n A r r a y ( i ,   n u m _ k e y s )   ! =   - 1 )   { 
                         s a m m y . p a r a m s [ i ]   =   p a r s e I n t ( s a m m y . p a r a m s [ i ] ) ; 
                 } 
                 e l s e   i f   ( j Q u e r y . i n A r r a y ( i ,   b o o l _ k e y s )   ! =   - 1 )   { 
                         s a m m y . p a r a m s [ i ]   =   s a m m y . p a r a m s [ i ]   = =   ' t r u e ' ; 
                 } 
                 e l s e   i f   ( j Q u e r y . i n A r r a y ( i ,   a r r a y a b l e _ k e y s )   ! =   - 1 )   { 
                         s a m m y . p a r a m s [ i ]   =   s a m m y . p a r a m s [ i ] . s p l i t ( '   ' ) ; 
                         i f   ( s a m m y . p a r a m s [ i ] . l e n g t h   = =   1 )   { 
                                 s a m m y . p a r a m s [ i ]   =   s a m m y . p a r a m s [ i ] [ 0 ] ; 
                         } 
                 } 
         } 
         v a r   p a r a m s   =   { " c o m p o n e n t " :   s a m m y . p a r a m s . c o m p o n e n t , 
                                     " v h o s t " :           s a m m y . p a r a m s . v h o s t , 
                                     " n a m e " :             s a m m y . p a r a m s . n a m e , 
                                     " v a l u e " :           p a r a m s _ m a g i c ( s a m m y . p a r a m s ) } ; 
         d e l e t e   p a r a m s . v a l u e . v h o s t ; 
         d e l e t e   p a r a m s . v a l u e . c o m p o n e n t ; 
         d e l e t e   p a r a m s . v a l u e . n a m e ; 
         s a m m y . p a r a m s   =   p a r a m s ; 
         i f   ( s y n c _ p u t ( s a m m y ,   ' / p a r a m e t e r s / : c o m p o n e n t / : v h o s t / : n a m e ' ) )   u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   p u t _ p o l i c y ( s a m m y ,   m a n d a t o r y _ k e y s ,   n u m _ k e y s ,   b o o l _ k e y s )   { 
         f o r   ( v a r   i   i n   s a m m y . p a r a m s )   { 
                 i f   ( i   = = =   ' l e n g t h '   | |   ! s a m m y . p a r a m s . h a s O w n P r o p e r t y ( i ) )   c o n t i n u e ; 
                 i f   ( s a m m y . p a r a m s [ i ]   = =   ' '   & &   j Q u e r y . i n A r r a y ( i ,   m a n d a t o r y _ k e y s )   = =   - 1 )   { 
                         d e l e t e   s a m m y . p a r a m s [ i ] ; 
                 } 
                 e l s e   i f   ( j Q u e r y . i n A r r a y ( i ,   n u m _ k e y s )   ! =   - 1 )   { 
                         s a m m y . p a r a m s [ i ]   =   p a r s e I n t ( s a m m y . p a r a m s [ i ] ) ; 
                 } 
                 e l s e   i f   ( j Q u e r y . i n A r r a y ( i ,   b o o l _ k e y s )   ! =   - 1 )   { 
                         s a m m y . p a r a m s [ i ]   =   s a m m y . p a r a m s [ i ]   = =   ' t r u e ' ; 
                 } 
         } 
         i f   ( s y n c _ p u t ( s a m m y ,   ' / p o l i c i e s / : v h o s t / : n a m e ' ) )   u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   u p d a t e _ c o l u m n _ o p t i o n s ( s a m m y )   { 
         v a r   m o d e   =   s a m m y . p a r a m s [ ' m o d e ' ] ; 
         f o r   ( v a r   g r o u p   i n   C O L U M N S [ m o d e ] )   { 
                 v a r   o p t i o n s   =   C O L U M N S [ m o d e ] [ g r o u p ] ; 
                 f o r   ( v a r   i   =   0 ;   i   <   o p t i o n s . l e n g t h ;   i + + )   { 
                         v a r   k e y   =   o p t i o n s [ i ] [ 0 ] ; 
                         v a r   v a l u e   =   s a m m y . p a r a m s [ m o d e   +   ' - '   +   k e y ]   ! =   u n d e f i n e d ; 
                         s t o r e _ p r e f ( ' c o l u m n - '   +   m o d e   +   ' - '   +   k e y ,   v a l u e ) ; 
                 } 
         } 
 
         p a r t i a l _ u p d a t e ( ) ; 
 } 
 
 f u n c t i o n   d e b u g ( s t r )   { 
         $ ( ' < p > '   +   s t r   +   ' < / p > ' ) . a p p e n d T o ( ' # d e b u g ' ) ; 
 } 
 
 f u n c t i o n   k e y s ( o b j )   { 
         v a r   k s   =   [ ] ; 
         f o r   ( v a r   k   i n   o b j )   { 
                 k s . p u s h ( k ) ; 
         } 
         r e t u r n   k s ; 
 } 
 
 / /   D o n ' t   u s e   t h e   j Q u e r y   A J A X   s u p p o r t ,   i t   s e e m s   t o   h a v e   t r o u b l e   r e p o r t i n g 
 / /   s e r v e r - d o w n   t y p e   e r r o r s . 
 f u n c t i o n   x m l H t t p R e q u e s t ( )   { 
         v a r   r e s ; 
         t r y   { 
                 r e s   =   n e w   X M L H t t p R e q u e s t ( ) ; 
         } 
         c a t c h ( e )   { 
                 r e s   =   n e w   A c t i v e X O b j e c t ( " M i c r o s o f t . X M L H t t p " ) ; 
         } 
         r e t u r n   r e s ; 
 } 
 
 / /   O u r   b a s e 6 4   l i b r a r y   t a k e s   a   s t r i n g   t h a t   i s   r e a l l y   a   b y t e   s e q u e n c e , 
 / /   a n d   w i l l   t h r o w   i f   g i v e n   a   s t r i n g   w i t h   c h a r s   >   2 5 5   ( a n d   h e n c e   n o t 
 / /   D T R T   f o r   c h a r s   >   1 2 7 ) .   S o   e n c o d e   a   u n i c o d e   s t r i n g   a s   a   U T F - 8 
 / /   s e q u e n c e   o f   " b y t e s " . 
 f u n c t i o n   b 6 4 _ e n c o d e _ u t f 8 ( s t r )   { 
         r e t u r n   b a s e 6 4 . e n c o d e ( e n c o d e _ u t f 8 ( s t r ) ) ; 
 } 
 
 / /   e n c o d e U R I C o m p o n e n t   h a n d l e s   u t f - 8 ,   u n e s c a p e   d o e s   n o t .   N e a t ! 
 f u n c t i o n   e n c o d e _ u t f 8 ( s t r )   { 
     r e t u r n   u n e s c a p e ( e n c o d e U R I C o m p o n e n t ( s t r ) ) ; 
 } 
 
 ( f u n c t i o n ( $ ) { 
         $ . f n . e x t e n d ( { 
                 c e n t e r :   f u n c t i o n   ( )   { 
                         r e t u r n   t h i s . e a c h ( f u n c t i o n ( )   { 
                                 v a r   t o p   =   ( $ ( w i n d o w ) . h e i g h t ( )   -   $ ( t h i s ) . o u t e r H e i g h t ( ) )   /   2 ; 
                                 v a r   l e f t   =   ( $ ( w i n d o w ) . w i d t h ( )   -   $ ( t h i s ) . o u t e r W i d t h ( ) )   /   2 ; 
                                 $ ( t h i s ) . c s s ( { m a r g i n : 0 ,   t o p :   ( t o p   >   0   ?   t o p   :   0 ) + ' p x ' ,   l e f t :   ( l e f t   >   0   ?   l e f t   :   0 ) + ' p x ' } ) ; 
                         } ) ; 
                 } 
         } ) ; 
 } ) ( j Q u e r y ) ; 
 
 f u n c t i o n   d e b o u n c e ( f ,   d e l a y )   { 
         v a r   t i m e o u t   =   n u l l ; 
 
         r e t u r n   f u n c t i o n ( )   { 
                 v a r   o b j   =   t h i s ; 
                 v a r   a r g s   =   a r g u m e n t s ; 
 
                 f u n c t i o n   d e l a y e d   ( )   { 
                         f . a p p l y ( o b j ,   a r g s ) ; 
                         t i m e o u t   =   n u l l ; 
                 } 
                 i f   ( t i m e o u t )   c l e a r T i m e o u t ( t i m e o u t ) ; 
                 t i m e o u t   =   s e t T i m e o u t ( d e l a y e d ,   d e l a y ) ; 
         } 
 } 
   "       http://localhost:15672/js/main.js        W               !«!ÿÿÿÿU      apply_state   dynamic_load	   leaf	   show1   update_filter_regex_mode)   collapse_multifields%   set_timer_interval   update_pages'   update_filter_regex   with_req   partial_update   sync_get%   fill_path_template+   has_auth_cookie_value+   update_column_options   b64_encode_utf8   update_filter#   renderConnections   postprocess   sync_put!   setup_extensions	   keys   start_app_login   put_parameter   update_truncate   show_popup   update_vhosts)   update_pages_from_ui#   toggle_visibility+   setup_constant_events   start_app   renderChannels   with_reqs   renderQueues   check_password   debounce   nav   update_status   update_interval   with_update/   url_pagination_template   x_position   auth_header+   login_route_with_path   publish_msg0   ejs_cached   submit_import   maybe_scroll   publish_msg%   update_multifields   set_auth_pref   params_magic5   contains_current_highlight   go_to   renderExchanges   sync_delete!   setup_visibility   dispatcher_add!   stored_page_info'   postprocess_partial   render   check_login#   update_multifield   obj_to_ul   full_refresh   update   format   update_manual   put_policy   replace_content'   maybe_remove_fields   xmlHttpRequest   dispatcher   get_msgs   sync_post%   check_bad_response   login_route   sync_req   debug   reset_timer!   multifield_input)   first_showable_child#   update_navigation   encode_utf8   y_positionU   U   «+H!«!          dispatcher_add                            n                               !«!ÿÿÿÿ      fun         «+H;ø   A                              ¸   
T  ç Q    Ù         æ
         ç  Qæ    ¸°Ï°¤¸°ÐÊ ¸°Ó¨° %   dispatcher_modules	   push   length   extension_count   start_app    ÿÿÿÿ   Ê5!«!          dispatcher                        q    q   
                        !«!ÿÿÿÿ      i   .this          «+H;ø         2      F                         ¹W  Q    K#   m   ÞW       V   Á
V  ç Qã   QLMÙÿÿÿæ   QN¦¸°?,Ëÿÿÿ÷¤¸°Ð°¬Õ¨° %   dispatcher_modules   ÿÿÿÿ   Ê5!«!          set_auth_pref   Æ  s  Æ            ÿÿÿÿ       Ê5!«!          login_route  Ý  ¾  È  ¾           ÿÿÿÿ       Ê5!«!       +   login_route_with_path  Þ    À    *         ÿÿÿÿ       Ê5!«!          start_app_login    7                      ­  È    È                           !«!ÿÿÿÿ               «+H!«!       )   start_app_login/app<c    8                    Û  l  Ò  l                           !«!ÿÿÿÿ      .this          «+H!«!    	   -   start_app_login/app</<b  ÿ    ÷    9          ÿÿÿÿ       Ê5!«!    	   -   start_app_login/app</<b  +  ê  #  ê  :   $      ÿÿÿÿ       Ê5!«!   \#\/login\/(.*) ;ø   k   *                     
 ¹W   QV   ¸    
=       ç QV   ¸   
=      ç QV   ¸    
=      ç QV   ¸    
       ç Q¦¸°Õ°¤¸°Õ°¬@¸°Õ°¤¸°Õ°¤°    get   #/   put   #/login7   #/login/:username/:password   login_route+   login_route_with_pathÊ5;ø   d   &                       
 Ö       5   A    ,  R     Q    ¸   
ç  Q      =   : @   æ         ç  Qæ    ¸°Ù°É¨C¸°Ì°¤¸°ÔÊ ¸°Ó¨G°    app   Sammy   Application   run!   get_cookie_value	   auth   check_loginÊ5!«!          check_login   I                     Þ  Æ
  Ê  Æ
                           !«!ÿÿÿÿ               «+H!«!            ;ø   û   \                         Ö       ¸   
      =   : :     Q    BM   æ         =   ç Q      =   ç Q      =	   =
   ç Qz   æ         =         =   [    : ç Q      ç  Q      ç  Q      ç  Q      ç  Q      ç  Qæ     ¸°à°ÿÿÿú°É ¸°Ê¨M¸°Ó ¸°Ó ¸°â¨Q ¸°ã°ÿÿÿç¤¸°Î ¸°Î ¸°Î ¸°Î ¸°Ó¨Y° 	   user	   JSON   parse   sync_get   /whoami   clear_pref	   auth%   clear_cookie_value   replace_content   login-status'   <p>Login failed</p>   outer   format   layout#   setup_global_vars+   setup_constant_events   update_vhosts   update_interval!   setup_extensions    ÿÿÿÿ   Ê5!«!          start_app   [                   Ú
  |  È
  |   
                         !«!ÿÿÿÿ      url   .this          «+H;ø   ´   E                      ¹W  Q       I   æ       ¸   
ç  Qæ   Ö       5   A   ,  R     Q    ¸   
ç  QV  5   ¸   
:  W   QV   ¸	   
=
   : ×ÿ   æ   V  V   =   6   Qæ   ¦¸°ËÊ ¸°Ì°É¨s¸°Ù°É ¸°Ì°¤¸°Ð°È ¸°Ð°Ê ¸°Ù¨y°    app   undefined   unload   Sammy   Application   dispatcher   run   location   toString   indexOf   #   #/   ÿÿÿÿ   Ê5!«!       +   setup_constant_events    {                        È  ~  È                           !«!ÿÿÿÿ               «+H!«!    	   /   setup_constant_events/<b  Ç  Ø  ¿  Ø  |   &      ÿÿÿÿ       Ê5!«!    	   /   setup_constant_events/<b  ÿ  ~  ÷  ~     $      ÿÿÿÿ       Ê5;ø   w   /                                =   : ¸   
    ç Q        =   : ¸   
   ç Q    '   æ           =   : ¸   
ç  Qæ    ¸°Þ°¬  ¸°Þ°¬  ¸°Ê ¸°Ù°É  °    $   #update-every   change   #show-vhost%   vhosts_interesting   #vhost-form	   hideÊ5!«!          update_vhosts                       à  W  Ê  W                           !«!ÿÿÿÿ      vhosts   select   index   i   vhost          «+H;ø       â         ´  «                 5     "     ¸   
      =   : : W   QÖ   V   Ù   ?   Q   ,   æ         =   : ¸   
ç  Q'   æ         =   : ¸	   
ç  Qæ         =
   : ¸   
>: W  QV  5   V   Ù   ?6   Q>W  Q>W  Q t   m   V   V  75   W  QV  5   V  ?   AV  V  ,  R 8QV        æ&   V  ?W  Qæ'   V  ìêW  QQã(   V  V   Ù   }ÿÿÿæ,   V  V  6   QÖ   V  5   V  75      Q      =      ç Q ¸°Û°ÿÿÿú°È ¸°Ö ¸°Ê ¸°Ù°Î  ¸°Ù°É ¸°Ú°È ¸°Ú ¸°¦	¸°&tb  ¦­   ¸°Ó ¸°á°¥¸°ÊÊ¸°Ð¨  '¸°Í¨  ¨  ¾°Ø¨  ¸°Î ¸°Þ ¸°Ø ° 	   JSON   parse   sync_get   /vhosts%   vhosts_interesting   length   $   #vhost-form	   show	   hide   #show-vhost   get   options	   name   Option   current_vhost   selectedIndex   value   store_pref   vhost    ÿÿÿÿ   Ê5!«!       !   setup_extensions   £                    r  Å  Y  Å                           !«!ÿÿÿÿ      extensions   i   extension          «+H;ø      =      
   Þ   W                           ¸   
      =   : : W   QÖ   >   QV   K   m	   ÞW  V   V  7W  Q   ¸   
V  : E   æ   QV  ¸   
=   : æ   8   æ   	   	   V  5   ç QÖ      ìê
   QQæ   ã   QLMlÿÿÿæ   QN ¸°Û°ÿÿÿú°È ¸°Ì ¸°>  Ëÿÿÿ÷¤¸°Î ¸°Ð°Þ&°ÈÊ ¸°× ¸°Ü¨  ¦Õ¨  ­° 	   JSON   parse   sync_get   /extensions   extension_count   $   isPlainObject   hasOwnProperty   javascript   dynamic_load    ÿÿÿÿ   Ê5!«!          dynamic_load  ¯                    Ü  É  Ç  É                            !«!ÿÿÿÿ      filename   element        «+H;ø   u   ,                          ¸   
=   : W   QV   ¸   
=   =   ç QV   ¸   
=   =   T  ç Q    ¸   
=	   : >7¸
   
V   ç Q ¸°Ñ	°È ¸°Õ°¤¸°Ù°¤¸°Ñ	°Ð °¤°    document   createElement   script   setAttribute	   type   text/javascript   src   js/)   getElementsByTagName	   head   appendChild    ÿÿÿÿ   Ê5!«!          update_interval   ¶                    ã  *  Ë  *                           !«!ÿÿÿÿ      intervalStr   interval   select	   opts   i          «+H;ø       ì   `      R                                 =   : W   QV   @   æ   XW  QD   æ   V   =      æ   @W  Q    æ         V   : W  Qæ	         V  :    æ   @W  Qæ         V  ç Q      =   : ¸   
>: W  QV  5	   W  Q>W  Q L   m   V  V  75
   V      æ   V  V  6   Q0   æ   V  ìêW  QQã   V  V  Ù   ¥ÿÿÿæ    ¸°×   ¸°Ê¸°Ò ¸°ÊÊ¸°Ð  ¸°Î°Í  ¸°ÑÊ¸°Ë  ¸°Ò  ¸°Ú°È ¸°Î 	¸°&L:`¦­  Ä ¸°ÓÊ ¸°Î ¸°PÊ¨  Ä%¸°Í¨  É¨  Ä¾°Ø¨  Ê°    get_pref   interval      parseInt   isNaN%   set_timer_interval   $   #update-every   get   options   value   selectedIndex   length    ÿÿÿÿ   Ê5!«!          go_to :  \  ,  \  Ì         ÿÿÿÿ       Ê5!«!       %   set_timer_interval  Ð                     y  ¹  ^  ¹                            !«!ÿÿÿÿ      interval         «+H;ø                             Ö    T      Q      ç  Q ¸°Î ¸°Î °    timer_interval   reset_timer    ÿÿÿÿ   Ê5!«!          reset_timer   Õ                     Ï  T  »  T                            !«!ÿÿÿÿ               «+H;ø   L                                      ç Q   @,   æ   Ö               :    Qæ    ¸°Ó ¸°Ê ¸°Ù°Î  °    clearInterval   timer   timer_interval   setInterval   partial_update    ÿÿÿÿ   Ê5!«!          update_manual l  ¬  V  ¬  Ü          ÿÿÿÿ       Ê5!«!          render  é                    ½  ³  ®  ³                           !«!ÿÿÿÿ   	   reqs   template   highlight   i        «+H;ø      (   3         A                      Ö    T     QÖ   T     Q   K$   m
   ÞW      V   7¸   
ç  Qã   QLMØÿÿÿæ   QNÖ   Z       QÖ   T    Q      ç  Q ¸°Î ¸°Î ¸°?-Ëÿÿÿ÷¤¸°Ñ°¬  ìÕ   ¸°Ð ¸°Î ¸°Î ° !   current_template   current_reqs!   outstanding_reqs   abort#   current_highlight   update    ÿÿÿÿ   Ê5!«!          update    ô                      Ä    µ                             !«!ÿÿÿÿ               «+H!«!    	      update/<b         ÷          ÿÿÿÿ       Ê5;ø   ?                                   =   =   ç Q         ç Q          ç Q ¸°Ø ¸°Ó ¸°Ó¨  °    replace_content   debug      clearInterval   timer   with_updateÊ5!«!          partial_update  *  õ!    õ!           ÿÿÿÿ         B <  á!  4  á!  
          ÿÿÿÿ       Ê5Ê5!«!       #   update_navigation  "  X%  ÷!  X%           ÿÿÿÿ       Ê5!«!          nav f%  %  Z%  %  B         ÿÿÿÿ       Ê5!«!       	   show %  Ò%  %  Ò%  F         ÿÿÿÿ       Ê5!«!       	   leaf á%  &  Ô%  &  J         ÿÿÿÿ       Ê5!«!       )   first_showable_child 4&  )'  &  )'  N         ÿÿÿÿ       Ê5!«!       5   contains_current_highlight N'  6(  +'  6(  X  #       ÿÿÿÿ       Ê5!«!          obj_to_ul J(  ;*  8(  ;*  e         ÿÿÿÿ       Ê5!«!          full_refresh  R*  ®*  =*  ®*  y         ÿÿÿÿ       Ê5!«!          maybe_scroll  Å*  +  °*  +  ~         ÿÿÿÿ       Ê5!«!          x_position  +  V,  +  V,           ÿÿÿÿ       Ê5!«!          y_position  k,  )-  X,  )-           ÿÿÿÿ       Ê5!«!          with_update                        ?-  S.  +-  S.                          !«!ÿÿÿÿ      fun        «+H!«!          with_update/<c    5                 ½-  >.  µ-  >.                            !«!ÿÿÿÿ   	   json	   html        «+H;ø   <                    	                T  : W   Q   V   ç Q      =   ç Q ¸°Ú ¸°Î ¸°Ó °    format!   current_template   update_status   ok    ÿÿÿÿ   Ê5;ø   J   1                           Ù   >   æ   Bæ                  : Z        ç QC ¸°ÌÊ ¸°© ¡® ¸°Ù
°Íÿÿÿö¬  ¸°¡± !   outstanding_reqs   length   with_reqs   apply_state   current_reqsÊ5!«!          apply_state   £                    i.  7  U.  7                         !«!ÿÿÿÿ
   	   reqs   reqs2   req   options	   req2   indexPage   qs	   type   range   prefix       «+H!«!            !«!            !«!          apply_state/<c  Ô  .                  z5  «6  q5  «6                            !«!ÿÿÿÿ      key         «+H;ø   ¹   G                       T  =    D(   æ   QT  =   D   æ   QT  =   æ      æ   æ   T   D   æ
   Q   T  7   æ      æ   æ      ¸   
      T  : =            T  7: ç Q  ¸°öÊ ¸°© Ü® Ø¸°ãÊ ¸°¡  ® Û
¸°Ù°Ü°ÿÿÿê°¤°    vhost	   sort   ranges   undefined	   push   esc   =    ÿÿÿÿ   Ê5;ø                   Q  ,   l                      P [    W   QT  KB  m   ÞÖ        T      7W  Q[      QV  '=   '   æ   V  5      QV  5   W  Qæ      5      E   æ   Q   =   æ   ½   æ   V  ¸   
=	   : W  QV  ×ÿc   æ   Ö
   V  ¸   
V  : 
   QV  ¸   
>V  : =            : 
   W  Q,   æ'   V  =            : W  Qæ,      æ,   V  W  Qæ,   Z       Q   5      E   æ2   Q   @æ4   @   æ5      ¸   
=      ç Q   ¸   
=      ç Qæ?      5        æD      5   Kp  mG   ÞÖ         5      7W  Q      =   : ¸   
=   : W  QV  ¸   
>×: =      æU   =   W  Q   æU   V  ¸   
>×
: =      æY   =   W  Q]   æY   V  ¸   
>×: =      æ]   =    W  Q(   æ]   V  =!      æ_   ="   W  Qæ_      ¸   
V  =#   $   $   V  >7: ç Q   ¸   
V  =%   $   $   V  ?7: ç Qão   QLMþÿÿæq   QNæq   &   ¸'   
   : ¸(   
   ç Q   ¸)   
=*   :    Q   =   V   æ}   V  ¸   
=	   : ×ÿ    æ   =*         Q   æ   =+         Qæ   V       V     8Qã   QLMºûÿÿæ   QNV    ¸°Ê ¸°= K× ¸°Î ¸°Ë ¸°ËÊ ¸°Ï ¸°Ó   ¸°ëÊ ¸°Ð°È ¸°Ê ¸°Ô°É ¸°Ð°Ø°Ù   ¸°Ù°Ø   ¸°Î  ¸°Ë ¸°çÊ ¸°×°¤¸°×°É  ¸°ÐÊ ¸°Ì8 y× ¸°Õ ¸°Þ°È  ¸°Î°ÉÊ ¸°Ô  ¸°Î°ÉÊ ¸°Ô  ¸°Î°ÉÊ ¸°Ô  ¸°ÊÊ ¸°Ï  ¸°æ°ÿÿÿè°¤¸°æ°ÿÿÿç°¬ ¿Ú¨ Ô¸°Ñ°Ï°¬ Ý¸°Ñ°É ¸°ËÊ ¸°Ð°Ê ¸°Û  ¸°Ö  ¸°Õ¨ ¥Õ¨ æ¸°¤±    k   object   options	   path   vhost   undefined   current_vhost      indexOf   ?page=   pageUrl   substr   /   esc	   sort   current_sort	   push   sort=   sort_reverse=)   current_sort_reverse   ranges   i   get_pref   chart-range   split   |   substring   lengths-   lengths   msg-rates-   msg_rates   data-rates-   data_rates   node-stats   node_stats   _age=   parseInt   _incr=   Object	   keys   forEach	   join   &   ?Ê5!«!          show_popup ¡7  A9  7  A9  é         ÿÿÿÿ          cssClass 	   hide	   	   hide  ò7  T8  å7  T8  ë         ÿÿÿÿ         B   8  L8  8  L8  ì  )      ÿÿÿÿ       Ê5Ê5   B  í8  =9  ä8  =9  ó  )       ÿÿÿÿ       Ê5Ê5!«!          submit_import Y9  <  C9  <  ù         ÿÿÿÿ       Ê5!«!          postprocess  +<  ÌK  <  ÌK  
         ÿÿÿÿ         B  [<  ý<  S<  ý<    +       ÿÿÿÿ       Ê5   B  2=  =  *=  =    1       ÿÿÿÿ       Ê5   B  ¾=  I>  ¶=  I>    %       ÿÿÿÿ       Ê5   B  h>  è?  `>  è?          ÿÿÿÿ       Ê5   B  @  ùA  @  ùA  $  -       ÿÿÿÿ       Ê5   B  #B  xB  B  xB  /  &      ÿÿÿÿ       Ê5   B  µB  åB  ­B  åB  3  9       ÿÿÿÿ       Ê5   B  $C  TC  C  TC  7  ;       ÿÿÿÿ       Ê5   B  C  úD  }C  úD  ;  -      ÿÿÿÿ       Ê5   B  +E  iE  #E  iE  I  -      ÿÿÿÿ       Ê5   B  ¨E  F   E  F  M  ;      ÿÿÿÿ       Ê5   B  ØF  tG  ÐF  tG  T  ?      ÿÿÿÿ       Ê5   B  ­G  H  ¥G  H  [  5       ÿÿÿÿ       Ê5   B  &H  ]H  H  ]H  _  !      ÿÿÿÿ       Ê5   B  H  J  H  J  c  &      ÿÿÿÿ       Ê5   B  kJ  J  cJ  J  o  W      ÿÿÿÿ       Ê5Ê5!«!       /   url_pagination_template                      îK  "N  ÎK  "N                            !«!ÿÿÿÿ      template   defaultPage   defaultPageSize'   page_number_request   page_size   name_request   use_regex        «+H;ø   Ê   ;                     
         T  T : W   Q      T  T : W  Q      T  =   : W  Q      T  =   : =   W  QV      æ         V  : W  Qæ   =   T  =   V   =	   V  =
   V  =   V   ¸°Ø ¸°Ø ¸°Ú ¸°à ¸°Ê ¸°Î°Í  ¸°É Ë Ë Ë Ë ± /   fmt_page_number_request+   fmt_page_size_request/   fmt_filter_name_request   #   fmt_regex_request   checked   esc   /   ?page=   &page_size=   &name=   &use_regex=    ÿÿÿÿ   Ê5!«!       !   stored_page_info =N  øP  $N  øP           ÿÿÿÿ       Ê5!«!          update_pages Q  IR  úP  IR  ¢         ÿÿÿÿ       Ê5!«!          renderQueues  `R  @S  KR  @S  ¬         ÿÿÿÿ       Ê5!«!          renderExchanges  ZS  IT  BS  IT  ²         ÿÿÿÿ       Ê5!«!       #   renderConnections   ¸             	       eT  /U  KT  /U                           !«!ÿÿÿÿ               «+H!«!       !«!	   sort!«!    !«!       !«!	   path!«!!«!   options!«!    !«!       !«!   connections!«!    ;ø   R   #           	                     [   [         =   ?×d: ]   [    C]   ]   ]   =   =   ç Q ¸°ÏÒ°È 
Ð Ê¨ ¹¤  °    render/   url_pagination_template   connections	   path	   sort   options   #/connections    ÿÿÿÿ   Ê5!«!          renderChannels  HU  þU  1U  þU  ¾         ÿÿÿÿ       Ê5!«!       )   update_pages_from_ui V  ïV   V  ïV  Ä         ÿÿÿÿ       Ê5!«!       '   postprocess_partial  W  ¨[  ñV  ¨[  Ë         ÿÿÿÿ         B DW   W  <W   W  Ì  2      ÿÿÿÿ       Ê5   B ÖW  X  ÎW  X  Ò  2      ÿÿÿÿ       Ê5   B :X  iX  2X  iX  Ö  1      ÿÿÿÿ       Ê5   B  Y  NY  Y  NY  Ý  L      ÿÿÿÿ       Ê5   B  oY  ©Z  gY  ©Z  á        ÿÿÿÿ       Ê5Ê5!«!       %   update_multifields  Å[  ,\  ª[  ,\  ö         ÿÿÿÿ         B ï[  (\  ç[  (\  ÷  %      ÿÿÿÿ       Ê5Ê5!«!       #   update_multifield H\  Ód  .\  Ód  ü         ÿÿÿÿ	       	   dict    largest_id    empty_found 	   name    type_inputs   B ]  ,b  
]  ,b          ÿÿÿÿ	       Ê5Ê5!«!       !   multifield_input îd  øg  Õd  øg  6         ÿÿÿÿ       Ê5!«!       '   update_filter_regex h  Ýi  úg  Ýi  J         ÿÿÿÿ       Ê5!«!       1   update_filter_regex_mode   j  tj  ßi  tj  W  !      ÿÿÿÿ       Ê5!«!          update_filter  j  k  vj  k  ]        ÿÿÿÿ       Ê5!«!          update_truncate  °k  1m  k  1m  h        ÿÿÿÿ       Ê5!«!       !   setup_visibility  Lm  p  3m  p  t         ÿÿÿÿ         B m  p  ~m  p  u  5      ÿÿÿÿ       Ê5Ê5!«!       #   toggle_visibility »p  Js  ¡p  Js           ÿÿÿÿ       Ê5!«!          publish_msg `s  t  Ls  t  ¥         ÿÿÿÿ       Ê5!«!          publish_msg0 6t  Yz  !t  Yz  ¯         ÿÿÿÿ         B =y  Uz  5y  Uz  Ë  ;       ÿÿÿÿ       Ê5Ê5!«!          get_msgs lz  ~|  [z  ~|  Õ         ÿÿÿÿ         B ùz  z|  ñz  z|  ×  ;       ÿÿÿÿ       Ê5Ê5!«!          with_reqs   ã                     |  a~  |  a~                          !«!ÿÿÿÿ   	   reqs   acc   fun   key        «+H!«!          with_reqs/<c  æ  1                 }  4~  }  4~                          !«!ÿÿÿÿ   	   resp   remainder   k        «+H!«!            ;ø      9   K      ¢   >                                ¸   
T  5   : 8Q[    W   Q   K<   m   ÞW  V        æ   V   V     V  78Qæ   ã   QLMÀÿÿÿæ   QN      V         ç Q ¸°Þ°¥ ¸°Ê ¸°?EËÿÿÿ÷¤¸°ÊÊ
¸°Ù¨ éÕ   ¸°Ü °    jQuery   parseJSON   responseText   with_reqs    ÿÿÿÿ   Ê5;ø      #                                  : Ù   >M   æ
              : >7   Q      =         7@    ç Q   æ         ç Qæ    ¸°ÙÊ ¸°Ú ¸°î¨ ï ¸°Ô  ° 	   keys   length   with_req   GETÊ5!«!          replace_content  ô                    {~  ¥~  c~  ¥~                            !«!ÿÿÿÿ      id	   html         «+H;ø   %                                  =   T  : ¸   
T ç Q ¸°à°¤°    $   #	   html    ÿÿÿÿ   Ê5!«!          format  ú                   Ì~  Õ  ½~  Õ                         !«!ÿÿÿÿ      template	   json   cache	   tmpl        !«!          err         «+H!«!       !«!   url!«!!«!   cache!«!    ;ø           {            ÿÿÿÿ      h                 (     CW   QT      q    æ       T  C8QBW   Qæ	      A[    =   T  =   ]   V   ]   ,  R W  QV  ¸   
T : £   æ     Qv  Q         ç Q	   ¸
   
=   V  ç Q	   ¸
   
=   V  5   ç Q      V  5   =   V  5   =   V  5   =   ç QÉ æ(    w¡¸°¦¸°ÊÊ ¸°Ë ¸°Ë  ¸°Ë	Ô%ÍÿÿÿÒÈ ¸°Î°« 	Í¨ Ì ¸°Ó ¸°Ö°¤¸°Û°¤¸°ÿ¥ °    ejs_cached   EJS   js/tmpl/	   .ejs   url   cache   render   clearInterval   timer   console   log!   Uncaught error:    Stack:    stack   debug	   name   :    message   
    ÿÿÿÿ   Ê5!«!          update_status í    ×             ÿÿÿÿ       Ê5!«!       +   has_auth_cookie_value                       $  W    W                            !«!ÿÿÿÿ               «+H;ø                                      =   : @ ¸°Ï°¥± !   get_cookie_value	   auth    ÿÿÿÿ   Ê5!«!          auth_header                        m  	  Y  	                            !«!ÿÿÿÿ               «+H;ø   O   *                  	              :  5   æ   =               =   : :    æ	   @æ	    ¸°ÍÊ ¸°Þ%°ÿÿÿí°¤   Ë¨ # ¸°¡ ¶ +   has_auth_cookie_value   Basic %   decodeURIComponent!   get_cookie_value	   auth    ÿÿÿÿ   Ê5!«!          with_req   (                      3    3                          !«!ÿÿÿÿ      method	   path	   body   fun	   json   req       «+H!«!       ?   with_req/req.onreadystatechangec   4  &                    ü    ü                            !«!ÿÿÿÿ      ix          «+H;ø   ª   C                          5    ×   æ      ¸   
      : W   QV   ×ÿ   æ      ¸   
V   ?ç Qæ            C: 1   æ   Ö      A,  R     Q      ç Qæ    ¸°ÍÊ ¸°Ö°È ¸°Ê ¸°Ñ°É  ¸°ÓÊ ¸°Ï°É ¸°Ô   °    readyState   jQuery   inArray!   outstanding_reqs   splice%   check_bad_response/   last_successful_connect	   Date    ÿÿÿÿ   Ê5;ø   Ô   j                 $             :      æ	      ¸   
ç  Qæ         :     Q   ¸   
T  =   T Cç Q   ¸   
=         :  ç Q   ¸   
=	   
   ç Q       6   Q   ¸   
   ç Q   ¸   
T ç Q ¸°Ê°Ê  ¸°Ì	°¤¸°© B® / ¸°Ó ¸°Ù°¤¸°Û&°ÿÿÿÞ°¤¸°Ö°¤¸°Ð¨ @¸°Ñ°¤¸°Ï°¤° +   has_auth_cookie_value   location   reload   xmlHttpRequest	   open   api!   setRequestHeader   authorization   auth_header   x-vhost   current_vhost%   onreadystatechange!   outstanding_reqs	   push	   sendÊ5!«!          sync_get  D                    F  v  5  v                            !«!ÿÿÿÿ   	   path         «+H;ø                                     =   Z    T  :  ¸°×°£±    sync_req   GET    ÿÿÿÿ   Ê5!«!          sync_put   Ü  x  Ü  H         ÿÿÿÿ       Ê5!«!          sync_delete ò  Z  Þ  Z  L         ÿÿÿÿ       Ê5!«!          sync_post n  Â  \  Â  P         ÿÿÿÿ       Ê5!«!          sync_req   T             	       Õ  Ú  Ä  Ú                        !«!ÿÿÿÿ   	   type   params0   path_template   options   params	   path   req       !«!          e         !«!          e         «+H!«!    	      sync_req/<b U    L    e  2       ÿÿÿÿ       Ê5;ø           3           `  [      ;   5   ÿÿÿÿ    n             Â  *   ÿÿÿÿ   P  ð          	       A    ,         T : W   Q      T V   : W  QB   æ	     Qv  Q      =         V  : ç QBÉÉ æ         :     Q   ¸   
T  =   V  Bç Q   ¸   
=	   =
   ç Q   ¸   
=         :  ç QT    D   æ   QT @æ   Y   æ    T 5      D   æ$   QT 5   @æ&   '   æ'      ¸   
T 5       ç Qæ+   T  =       æ-      ¸   
@ç Q-   æ0      ¸   
   ¸   
V   : ç Qæ6   7   æ6     Qv  QV  5   <    àA   æ9   É æ9            B: >   æ=   T  =      æ?      5      æA   CæA      æA   BæA      /¡¸°Í	°È ¸°Ñ°Ô Ì ¸°Ý°ÿÿÿí¤¸°© Ê¨ ^¸°Ó ¸°Ú°¤¸°Ö°¤¸°Û&°ÿÿÿÞ°¤ ¸°ÞÊ ¸°èÊ ¸°Ù°É¨ kW¡¸°ÉÊ ¸°Í°Î  ¸°Ü°ÿÿÿö°Õ  Ì ¸°ÓÑ¨ y¸°ÓÊ ¸°ÉÊ ¸°Ê¨ Ë¨ }¸°© Ð¨  ¸°¡ ¶    params_magic%   fill_path_template   show_popup	   warn   fmt_escape_html   xmlHttpRequest	   open   api!   setRequestHeader   content-type!   application/json   authorization   auth_header   undefined   headers   jQuery	   each   GET	   send	   JSON   stringify   number%   check_bad_response   responseTextÊ5!«!       %   check_bad_response                       ÷  ü  Ü  ü                          !«!ÿÿÿÿ      req   full_page_404	   html   reason   error   seconds   contexts   matches       «+H!«!            !«!   api\/(.*)\? !«!    	   )   check_bad_response/<b ¦           .       ÿÿÿÿ       Ê5;ø,     Z                    K T  5    XÈ E   æ   QT  5    X,æ   D   æ	   QT  5    XÇæ      æ   C5  æ   T  5    XE   æ   QT æ   B   æ         =   [    : W   Q      =   V   ç QÏ  æ   T  5    XE   æ   QT  5    Xæ   }  æ      ¸   
T  5   : 5   W  QV  '=	   "   æ#      ¸
   
V  : W  Qæ&      ¸   
T  5   : 5   W  QV  '=	   "   æ.      ¸
   
V  : W  Qæ1   V  =   D*   æ3   QV  =   D   æ5   QV  =   æ6   3   æ7         =         V  : ç Q\  æ;   V  =   H  æ=   ×<W  Q   >:   æ@      A,  R  ¸   
:     ¸   
:  XèW  QæI   V  ×ê   æK      ¸   
=   ç QZ   =   `    =   `   =   `   =   `   W  Q    ¸   
T  5   :    Q   @E   æY   Q   Ù   ?æ\   #   æ]   V  ¸    
   ç Q   æ_   !   !   "   ?ç Qæb   Ö      A,  R     Qæf   %  æf   T  5    X"   æi   #   #   =$   ç Qò   æk   T  5    >"   æn   #   #   =   ç QÁ   æp   T  5    Xà."   æs   #   #   =   ç Q   æu   T  5    X÷"   æx   #   #   =   ç Q[   æz   %   %   =&   T  5    ='   (   (   T  5   : =)   ç Q*   *   +   ç Qæ   B   	¸°ÿÊ ¸°© »Ë¨ ¸°ßÊ ¸°Ü ¸°á  ¸°èÊ ¸°Ô°Í ¸°ËÊ¸°Ð°Í  ¸°Ô°Í ¸°ËÊ¸°Ð°Í  ¸°ùÊ ¸°Ý°ÿÿÿíÎ ¸°ÊÊ ¸°§¸°Ê ¸°Ê°Ê°Ï)°Ò ¸°Ê ¸°Ñ°¤ ¸°Ê
ÊÊÏ ¸°Ô°É ¸°ãÊ ¸°Ð	°Î   ¸°Ù  ¸°Ï°Ø    ¸°ÌÊ ¸°Ý  ¸°ÊÊ ¸°Ý  ¸°ÌÊ ¸°Ý  ¸°ÌÊ ¸°Ý   ¸°ðL°Êÿÿÿ´¤¸°Ø   ¸°¡±    status   format   404   replace_content	   main	   JSON   parse   responseText   reason   string   stringify   error   bad_request   not_found   not_authorised   show_popup	   warn   fmt_escape_html#   page_out_of_range9   last_page_out_of_range_error	   Date   getTime   Sammy   logu   server reports page is out of range, redirecting to page 1   queues   exchanges   connections   channels	   exec   responseURL   length   forEach   update_pages!   current_template   update_status   timeout   debugI   Management API returned status code     - <strong>1   fmt_escape_html_one_line   </strong>   clearInterval   timerÊ5!«!       %   fill_path_template   ½                      4  þ  4                          !«!ÿÿÿÿ      template   params   re       «+H!«!   :[a-zA-Z_]*!«!    	   )   fill_path_template/<b s  0  k  0  ¿  (       ÿÿÿÿ       Ê5;ø   "                              W   QT  ¸    
V      :  ¸°Ê ¸°Ó°« Æ±    replaceÊ5!«!          params_magic  È                    K  ¥  6  ¥                            !«!ÿÿÿÿ      params         «+H;ø   ,                                              T  : : :  ¸°á*°ÿÿÿì°ÿÿÿñ°£±    check_password'   maybe_remove_fields)   collapse_multifields    ÿÿÿÿ   Ê5!«!       )   collapse_multifields   Ì                    Ä  ¡  §  ¡                          !«!ÿÿÿÿ      params0   set   params   ks   ids   key   match   match2   match3	   name   id   id_map   id_parts   k   v   t   val   top_level   n   prefix        «+H!«!    	      set à    Ô    Í         ÿÿÿÿ       Ê5!«!            !«!3   ([a-z]*)_([0-9_]*)_mftype !«!)   [a-z]*_[0-9_]*_mfkey !«!-   [a-z]*_[0-9_]*_mfvalue !«!            !«!            !«!            ;ø      >   ,                                 v    1     W   Q[   W  Q        T  : W  QZ    W  QV  K  m   ÞÖ      V     7W  QV  ¸   
    : W  QV  ¸   
    : W  QV  ¸   
    : W  QV  @E"   æ   QV  @E   æ   QV  @æ   !   æ   V  V  T  V  78Qa   æ   V  @   æ   G   æ   V  ?7W  QV  ×7W	  QV  ¸   
Z   V  `    V	  `   ç Qæ"   ã"   QLMßþÿÿæ$   QNV  ¸   
ç  Q[   W
  QV  Kö  m(   ÞÖ      V     7>7W  QV     7?7W	  QV  V  7   (   æ4   V  V  [   8QV
  V  [   8Qæ8   V	  ¸   
=   : W  QT  V  =   V  >7=   7W  QT  V  =   V	  =	   7W  QT  V  =   V	  =
   7W  Q@W  QV  Ù   ?W  QV  =   ,   æK   Z    W  QV
  V  7V	  V  8Q6  æN   V   V  : E   æP   QV  æP   D   æQ   QV   V  : æR   ð   æS   V  =   a   æU   V  =   E   æW   QV  =   æX      æY   V  =   V  pæ[   V  =   W  Q   æ\   V  =   ^   æ^         V  : W  Q      V  :    æc   V  =   V  pæe   V  W  Q   æe   V  W  Qæe   V  @   æg   V  "   æh   V  V  7V  V  8QU   æj   V  ¸   
>V  Ù   ?: ¸   
=   : W  QV
  V  7V  7¸   
V  ç Qæt   ãt   QLMýÿÿæv   QNV  Ê   ¸°Ê ¸°Õ ¸°Ê ¸°> &× ¸°Ï ¸°Ð°È ¸°Ð°È ¸°Ð°È ¸°íÊ ¸°Ü  ¸°Ô    ¸°Ë ¸°Ì ¸°Ð
ÉÉÿÿÿô°É¨ ÒÕ¨ ã¸°Ë°¤¸°Ê ¸°> ÿ× ¸°Ñ ¸°Ñ ¸°ÏÊ ¸°Ï ¸°Ô  ¸°Ð°È ¸°à ¸°Þ ¸°Þ ¸°¦¸°Ð ¸°ÊÊ ¸°Ê ¸°Ý  ¸°ô°ÈÊ ¸°ÊÊ ¸°äÊ ¸°Õ ¸°Ù  ¸°ÊÊ ¸°Ö ¸°ÑÊ ¸°Õ ¸°Ó   ¸°Î   ¸°Ê ¸°Ê ¸°Ý   ¸°×	°Ï°È ¸°Ù°É¨ åÕ¨ ¸°¤± 	   keys   i   match	   push	   sort   undefined   split   _   _mfkey   _mfvalue   _mftype   length	   list   boolean	   true   falseA    must be "true" or "false"; got    number   parseFloat   isNaN/    must be a number; got    slice	   joinÊ5!«!          check_password                      4¡  ¢  ¡  ¢                            !«!ÿÿÿÿ      params         «+H;ø   t   6                       T  5       \   æ   T  5    =      æ	   =   pæ	   T  5    T  5      æ   =   pæ   T  %   Qæ   T   ¸°ÎÊ ¸°ÎÊ ¸°Ë  ¸°ÑÊ ¸°Ë  ¸°Î   ¸°£±    password   undefined   5   Please specify a password.!   password_confirm/   Passwords do not match.    ÿÿÿÿ   Ê5!«!       '   maybe_remove_fields   !                     ©¢  F¤  ¢  F¤                          !«!ÿÿÿÿ      params        «+H!«!    	   +   maybe_remove_fields/<b ß¢  /¤  ×¢  /¤  "  +      ÿÿÿÿ       Ê5;ø   )                                  =   : ¸   
    ç Q    ¸°Þ°¬ .¸°¥±    $)   .controls-appearance	   eachÊ5!«!          put_parameter ^¤  '©  H¤  '©  1         ÿÿÿÿ       Ê5!«!          put_policy <©  «  )©  «  P         ÿÿÿÿ       Ê5!«!       +   update_column_options ««  /­  «  /­  `         ÿÿÿÿ       Ê5!«!          debug ?­  x­  1­  x­  n         ÿÿÿÿ       Ê5!«!       	   keys  r                   ­  ã­  z­  ã­                           !«!ÿÿÿÿ      obj   ks   k        «+H;ø         1      L   .                      Z    W   QT  K"   m   ÞW  V   ¸    
V  ç Qã   QLMÚÿÿÿæ   QNV    ¸°Ê ¸°=+Ëÿÿÿ÷¤¸°Ï°¬ tÕ   ¸°¤± 	   push    ÿÿÿÿ   Ê5!«!          xmlHttpRequest   |                   a®  ¯  J®  ¯                          !«!ÿÿÿÿ      res          !«!          e         «+H;ø                    $   ÿÿÿÿ   O   &                           A,  R  W   Q1   æ     Qv  Q   A=   ,  R W   QÉ æ   V     ¡¸°Ê°Ô  Ì ¸°Ï°Ï  ¸°¤±    XMLHttpRequest   ActiveXObject#   Microsoft.XMLHttp    ÿÿÿÿ   Ê5!«!          b64_encode_utf8 þ¯  3°  æ¯  3°           ÿÿÿÿ       Ê5!«!          encode_utf8 °  ¼°  s°  ¼°           ÿÿÿÿ       Ê5!«!          debounce g²  ¡³  V²  ¡³            ÿÿÿÿ          f    delay    timeout   B   ²  ³  ²  ³  £       ÿÿÿÿ          obj 	   args	      delayed  õ²  ?³  ä²  ?³  §         ÿÿÿÿ       Ê5Ê5Ê5!«!       C                           j      j                            !«!ÿÿÿÿ               «+H!«!            ;ø   9                                   =         =   [    : ç Q      ç  Q ¸°ã°ÿÿÿç¤¸°Î °    replace_content   outer   format   login   start_app_login    ÿÿÿÿ   Ê5!«!            !«!       C                        Ç°  J²  ¿°  J²                         !«!ÿÿÿÿ      $        «+H!«!          centerB  ÷°  @²  î°  @²          ÿÿÿÿ         B  !±  4²  ±  4²    %      ÿÿÿÿ       Ê5Ê5!«!       !«!   center!«!    ;ø   %                             5    ¸   
[       ]   ç Q ¸°Ö Ê¨ 	°¬ °    fn   extend   centerÊ5;ø   ?  5   ý             
                                      	   
                                                                      !   "   #   $   %   &   '   (   )   *   +   ,   -   .   /   0   1   2   3   4   5   6   7   8   9   :   ;   <   =   >   ?   @   A   B   C   D   E   F   G   H   I   J   K   L   M   N   O   P   Q   R   S            : ¸   
T   ç QÖ    [U       QV      ç Qÿÿÿÿÿÿÿÿ½°Þ°¬ ¨ ø¸°Ë¨ ¸°® °¬ ¯°    ejs_cached   $   document   ready   jQueryé[×9U      ^UÄW^UÄWAe®^UÆI   "    :http://localhost:15672/js/main.js strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
content-length: 45986
content-type: application/javascript
etag: "3442912102"
last-modified: Tue, 25 Feb 2020 23:42:19 GMT
date: Wed, 26 Feb 2020 01:05:27 GMT
server: Cowboy
 original-response-headers server: Cowboy
date: Tue, 25 Feb 2020 23:48:11 GMT
content-length: 45986
content-type: application/javascript
etag: "3442912102"
last-modified: Tue, 25 Feb 2020 23:42:19 GMT
 ctid 2 uncompressed-len 0 necko:classified 1 alt-data 1;45986,javascript/moz-bytecode-20190718161435 alt-data-from-child 1  ¦F